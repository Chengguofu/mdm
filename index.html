<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>主数据管理平台</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    :root {
      --theme-bg: #f7faff;
      --theme-topbar: linear-gradient(90deg, #2176c7 60%, #3ba1e3 100%);
      --theme-sidebar: #fff;
      --theme-content: #f4f8fb;
      --theme-topbar-font: #fff;
      --theme-menu-active: #2176c7;
      --theme-menu-hover: #185a99;
      --theme-table-header: #f4f8fb;
      --theme-table-header-font: #2176c7;
      --theme-table-row-hover: #f0f6fd;
      --theme-table-border: #e3eaf3;
      --theme-btn: #2176c7;
      --theme-btn-hover: #185a99;
      --theme-avatar-bg: #eaf3fb;
      --theme-avatar-font: #2176c7;
      --theme-content-text: #185a99;
      --theme-shadow-color: rgba(33, 118, 199, 0.06);
    }

    /* Toggle Switch for Advanced Mode */
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
    }
    input:checked + .slider {
      background-color: var(--theme-menu-active, #2176c7);
    }
    input:focus + .slider {
      box-shadow: 0 0 1px var(--theme-menu-active, #2176c7);
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    .slider.round {
      border-radius: 24px;
    }
    .slider.round:before {
      border-radius: 50%;
    }

    /* 导出下拉菜单样式 */
    .export-menu-item:hover {
      background: #f0f6fd;
    }
    .export-menu-item .icon {
      margin-right: 8px;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
      background: var(--theme-bg);
      color: #222;
    }
    .layout {
      display: flex;
      height: 100vh;
      flex-direction: column;
    }
    .topbar {
      height: 56px;
      background: var(--theme-topbar);
      color: var(--theme-topbar-font);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 32px;
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px rgba(33, 118, 199, 0.08);
      z-index: 10;
      position: relative;
    }
    .topbar-left {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .logo {
      width: 120px;
      height: 36px;
      background: transparent;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      color: #2176c7;
      font-weight: bold;
      margin-right: 8px;
    }
    .topbar-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--theme-topbar-font);
      letter-spacing: 1px;
    }
    .topbar-right {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 15px;
    }
    .topbar-time {
      background: rgba(255,255,255,0.13);
      border-radius: 16px;
      padding: 2px 18px;
      font-size: 15px;
      color: #fff;
      margin-right: 4px;
      letter-spacing: 1px;
      font-weight: 500;
      display: flex;
      align-items: center;
      height: 32px;
    }
    .icon-btn {
      display: inline-flex;
      align-items: center;
      background: #2176c7;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 4px 12px;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.18s;
      height: 32px;
      line-height: 1;
    }
    .icon-btn .icon {
      display: inline-block;
      vertical-align: middle;
    }
    .icon-btn:hover {
      background: #185a99;
    }
    .ai-avatar-icon {
      width: 28px;
      height: 28px;
      display: block;
    }
    .user-info {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 17px;
      font-weight: 500;
      cursor: pointer;
      position: relative;
    }
    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--theme-avatar-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--theme-avatar-font);
      margin-left: 6px;
    }
    .user-dropdown {
      position: absolute;
      top: 44px;
      right: 0;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 24px rgba(33, 118, 199, 0.13);
      min-width: 140px;
      z-index: 100;
      padding: 10px 0;
      display: none;
    }
    .user-dropdown.show {
      display: block;
    }
    .user-dropdown-item {
      padding: 10px 24px;
      font-size: 15px;
      color: #2176c7;
      cursor: pointer;
      transition: background 0.18s;
      white-space: nowrap;
    }
    .user-dropdown-item:hover {
      background: #f0f6fd;
      color: #185a99;
    }
    .main {
      display: flex;
      flex: 1;
      min-height: 0;
      height: calc(100vh - 56px);
    }
    .sidebar {
      width: 220px;
      background: var(--theme-sidebar);
      border-right: 1px solid var(--theme-table-border);
      box-shadow: 2px 0 8px rgba(33, 118, 199, 0.03);
      display: flex;
      flex-direction: column;
      padding-top: 12px;
      overflow-y: auto;
      height: 100%;
      min-height: 0;
    }
    .menu {
      list-style: none;
      margin: 0;
      padding: 0 0 16px 0;
    }
    .menu-item {
      padding: 0;
      font-size: 16px;
      color: #185a99;
      cursor: pointer;
      border-left: 4px solid transparent;
      transition: background 0.2s, border-color 0.2s;
      user-select: none;
      font-weight: 500;
    }
    .menu-item-header {
      padding: 12px 32px 12px 32px;
      display: flex;
      align-items: center;
      width: 100%;
      cursor: pointer;
    }
    .menu-item.active .menu-item-header, .menu-item:hover .menu-item-header {
      background: var(--theme-table-row-hover);
      color: var(--theme-menu-active);
    }
    .menu-item.active {
      border-left: 4px solid var(--theme-menu-active);
    }
    .menu-item.is-favorited-and-hidden {
      visibility: hidden !important;
      height: 0 !important;
      overflow: hidden !important;
      padding-top: 0 !important;
      padding-bottom: 0 !important;
      margin-top: 0 !important;
      margin-bottom: 0 !important;
      border: none !important;
      line-height: 0 !important;
      font-size: 0 !important; /* Ensure no text takes space */
      display: none !important; /* Added to ensure the element is completely hidden */
    }
    /* Explicitly hide the header inside the hidden menu item */
    .menu-item.is-favorited-and-hidden .menu-item-header {
        display: none !important;
        width: 0 !important; /* Ensure it takes no width either */
        padding: 0 !important;
        margin: 0 !important;
    }
    .favorite-icon {
      margin-left: auto;
      font-size: 18px;
      color: #ccc;
      cursor: pointer;
      transition: color 0.2s, background 0.2s, opacity 0.2s;
      padding: 4px 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .favorite-icon:hover {
      opacity: 0.8;
      background: rgba(255,255,255,0.3);
    }
    .favorite-icon.favorited {
      color: #FFD700; /* Gold color for favorited */
      background: rgba(255,215,0,0.1);
    }
    /* Styling for favorite icon in the favorited items list (Common Menu) */
    #favoritedItemsList .submenu-item .favorite-icon {
        color: #ccc !important; /* Make it gray when in favorited list */
        background: rgba(255,255,255,0.7) !important; /* Add a subtle background */
        cursor: pointer; /* Keep cursor pointer to indicate clickability */
        margin-right: 0; /* Align to the very right */
        padding: 2px 6px !important; /* Smaller padding for better fit in submenu */
        border: 1px solid #ddd !important; /* Subtle border */
        border-radius: 4px !important; /* Slightly rounded corners */
        opacity: 0.9; /* Slight transparency */
    }
    #favoritedItemsList .submenu-item .favorite-icon:hover {
        background: rgba(230,230,230,0.9) !important;
        opacity: 1;
    }
    .menu-item-icon {
      margin-right: 10px; /* Space between icon and text */
      display: flex;
      align-items: center;
      justify-content: center;
      width: 20px; /* Ensure consistent icon size */
      height: 20px;
      color: #2176c7; /* A subtle color for the icons */
    }
    .menu-item-icon svg {
      width: 100%;
      height: 100%;
    }
    .submenu {
      list-style: none;
      margin: 0;
      padding: 0 0 0 32px;
      background: #f8fbff;
      display: none; /* 默认隐藏二级菜单 */
      transition: all 0.3s ease; /* 添加过渡动画 */
    }
    .menu-item.open .submenu {
      display: block; /* 当菜单项有open类时显示二级菜单 */
    }
    .submenu-item {
      padding: 10px 32px;
      font-size: 15px;
      color: #333;
      cursor: pointer;
      transition: background 0.18s;
      white-space: nowrap;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .submenu-item .favorite-btn {
      margin-left: 8px;
      color: #ccc;
      cursor: pointer;
      transition: color 0.2s;
      font-size: 14px;
      padding: 2px 6px;
      border-radius: 4px;
      background: rgba(255,255,255,0.1);
    }
    .submenu-item .favorite-btn:hover {
      color: #FFD700;
      background: rgba(255,215,0,0.1);
    }
    .submenu-item .favorite-btn.favorited {
      color: #FFD700;
      background: rgba(255,215,0,0.1);
    }
    #favoritedItemsList .submenu-item {
      padding: 8px 32px;
      font-size: 14px;
    }
    #favoritedItemsList .submenu-item .favorite-btn {
      color: #FFD700;
      background: rgba(255,215,0,0.1);
    }
    .content {
      flex: 1;
      background: var(--theme-content);
      padding: 32px;
      min-width: 0;
      overflow: auto;
      position: relative;
      height: 100%;
    }
    .menu-item .arrow {
      margin-right: 8px;
      font-size: 12px;
      color: #bbb;
      transition: transform 0.2s;
    }
    .menu-item.open .arrow {
      transform: rotate(90deg);
      color: var(--theme-menu-active);
    }
    /* 表格样式 */
    .table-wrap {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(33, 118, 199, 0.06);
      padding: 20px;
      overflow-x: auto;
    }
    table.model-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 15px;
      background: #fff;
      min-width: 1100px;
    }
    .model-table th, .model-table td {
      padding: 10px 12px;
      border-bottom: 1px solid var(--theme-table-border);
      text-align: left;
      white-space: nowrap;
    }
    .model-table th {
      background: var(--theme-table-header);
      color: var(--theme-table-header-font);
      font-weight: 600;
    }
    .model-table tr:last-child td {
      border-bottom: none;
    }
    .model-table tr:hover td {
      background: var(--theme-table-row-hover);
    }
    .model-table td a {
      color: #185a99;
      text-decoration: underline;
      cursor: pointer;
    }
    .model-table td a:hover {
      color: var(--theme-menu-active);
    }
    .model-table td {
      color: #222;
    }
    .model-table td.center {
      text-align: center;
    }
    .model-table td.checkbox-cell, .model-table th.checkbox-cell {
      width: 36px;
      text-align: center;
    }
    /* 查询区和按钮区样式 */
    .query-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 18px 24px;
      align-items: center;
      margin-bottom: 18px;
      padding: 0 0 0 6px;
    }
    .query-bar label {
      font-size: 15px;
      color: #185a99;
      margin-right: 6px;
    }
    .query-bar input, .query-bar select {
      padding: 6px 10px;
      border: 1.2px solid #c0d3eb;
      border-radius: 4px;
      font-size: 15px;
      background: #f9fbfd;
      min-width: 120px;
      margin-right: 8px;
    }
    .query-bar button {
      background: var(--theme-btn);
      color: #fff;
      border: none;
      padding: 6px 18px;
      border-radius: 5px;
      font-size: 15px;
      cursor: pointer;
      font-weight: 500;
      margin-right: 8px;
      transition: background 0.2s;
    }
    .query-bar button:hover {
      background: var(--theme-btn-hover);
    }
    .action-bar {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 18px;
      padding: 16px 20px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(33, 118, 199, 0.06);
    }
    .btn-main {
      background: #4db6ac;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 0 18px;
      height: 36px;
      font-size: 15px;
      display: flex;
      align-items: center;
      font-weight: 500;
      transition: background 0.18s;
    }
    .btn-main:hover {
      background: #399488;
    }
    .btn-line {
      background: #fff;
      color: #444;
      border: 1px solid #d0d7de;
      border-radius: 4px;
      padding: 0 14px;
      height: 36px;
      font-size: 15px;
      display: flex;
      align-items: center;
      transition: background 0.18s, border 0.18s;
    }
    .btn-line:hover {
      background: #f5f7fa;
      border-color: #b0b8c1;
    }
    .action-bar .icon {
      margin-right: 6px;
      display: flex;
      align-items: center;
    }
    /* 主题设置下拉菜单 */
    .theme-dropdown {
      position: absolute;
      top: 44px;
      right: 0;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 24px rgba(33, 118, 199, 0.13);
      min-width: 170px;
      z-index: 100;
      padding: 10px 0;
      display: none;
    }
    .theme-dropdown.show {
      display: block;
    }
    .theme-dropdown-title {
      font-size: 16px;
      font-weight: 600;
      color: #6b7a8f;
      padding: 0 20px 8px 20px;
      margin-bottom: 2px;
    }
    .theme-dropdown-list {
      display: flex;
      flex-direction: column;
      gap: 2px;
      padding: 0 10px;
    }
    .theme-dropdown-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 7px 10px;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.18s, color 0.18s;
      white-space: nowrap;
      color: #2176c7;
    }
    .theme-dropdown-item.selected {
      background: #eaf3fb;
      color: #2176c7;
      font-weight: 600;
    }
    .theme-dropdown-item:hover {
      background: #f0f6fd;
      color: #2176c7;
    }
    .theme-dot {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      display: inline-block;
      border: 1.5px solid #e3eaf3;
    }
    /* AI对话抽屉 */
    .drawer-mask {
      position: fixed;
      top: 0; right: 0; bottom: 0; left: 0;
      background: rgba(33, 118, 199, 0.10);
      z-index: 3000;
      display: none;
    }
    .drawer {
      position: fixed;
      top: 0; right: 0; bottom: 0;
      width: 420px;
      max-width: 98vw;
      background: #fff;
      box-shadow: -2px 0 16px rgba(33, 118, 199, 0.18);
      z-index: 3100;
      display: flex;
      flex-direction: column;
      animation: drawerIn .25s;
    }
    @keyframes drawerIn {
      from { right: -440px; opacity: 0; }
      to { right: 0; opacity: 1; }
    }
    .drawer-header {
      padding: 14px 20px;
      font-size: 16px;
      font-weight: 600;
      color: #333;
      border-bottom: 1px solid #e3eaf3;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .drawer-close {
      background: none;
      border: none;
      font-size: 22px;
      color: #999;
      cursor: pointer;
    }
    .drawer-content {
      flex: 1;
      padding: 0;
      overflow-y: auto;
      font-size: 15px;
      color: #222;
      background: #f8fbff;
    }
    .drawer-footer {
      padding: 16px 24px;
      background: #fff;
      border-top: 1px solid #e3eaf3;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .drawer-footer input {
      flex: 1;
      padding: 8px 12px;
      border: 1.2px solid #c0d3eb;
      border-radius: 24px;
      font-size: 15px;
      background: #fff;
    }
    .drawer-footer button {
      background: #2176c7;
      color: #fff;
      border: none;
      padding: 7px 18px;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }
    .drawer-footer button:hover {
      background: #185a99;
    }
    @media (max-width: 700px) {
      .sidebar { width: 120px; }
      .menu-item, .submenu-item { font-size: 13px; padding-left: 12px; }
      .content { padding: 10px; }
      .topbar { font-size: 16px; padding: 0 10px; }
      .table-wrap { padding: 4px 0 0 0; }
      table.model-table { min-width: 800px; }
      .topbar-title { font-size: 15px; }
      .logo { width: 28px; height: 28px; font-size: 16px; }
      .user-avatar { width: 24px; height: 24px; font-size: 13px; }
      .drawer { width: 98vw; }
    }
    .quick-actions-card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 12px rgba(33,118,199,0.08);
      padding: 32px 24px 24px 24px;
      margin-bottom: 24px;
      max-width: 420px;
    }
    .quick-actions-title {
      display: flex;
      align-items: center;
      font-size: 28px;
      font-weight: 700;
      color: #222;
      margin-bottom: 6px;
    }
    .quick-actions-title svg {
      color: #2176c7;
      margin-right: 10px;
    }
    .quick-actions-desc {
      color: #888;
      font-size: 15px;
      margin-bottom: 28px;
    }
    .quick-actions-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 22px 22px;
    }
    .quick-action-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 600;
      color: #fff;
      height: 110px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(33,118,199,0.08);
      position: relative;
      transition: transform 0.12s, box-shadow 0.12s;
      user-select: none;
    }
    .quick-action-btn:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 6px 18px rgba(33,118,199,0.13);
      opacity: 0.95;
    }
    .quick-action-btn .icon {
      font-size: 32px;
      margin-bottom: 8px;
    }
    .quick-action-btn .remove-btn {
      position: absolute;
      top: 8px;
      right: 10px;
      background: rgba(255,255,255,0.85);
      color: #e74c3c;
      border: none;
      border-radius: 50%;
      width: 26px;
      height: 26px;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 2;
      opacity: 0.8;
      transition: background 0.15s;
    }
    .quick-action-btn .remove-btn:hover {
      background: #ffeaea;
      opacity: 1;
    }
    .quick-actions-add {
      margin-top: 18px;
      text-align: right;
    }
    .quick-actions-add button {
      background: #2176c7;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 7px 18px;
      font-size: 15px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.18s;
    }
    .quick-actions-add button:hover {
      background: #185a99;
    }
    .quick-entry-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 17px;
      font-weight: 600;
      color: #185a99;
      margin-bottom: 12px;
    }
    .quick-entry-header .right-btns {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .quick-entry-add-btn {
      background: #eaf3fb;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      color: #2176c7;
      font-size: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    .quick-entry-edit-btn {
      background: #eaf3fb;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      color: #bbb;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    .quick-entry-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      align-items: center;
    }
    .quick-entry-item {
      width: 110px;
      height: 110px;
      background: #fff;
      border: 1.5px solid #f0f0f0;
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: box-shadow 0.18s, border 0.18s;
      position: relative;
      user-select: none;
      box-sizing: border-box;
    }
    .quick-entry-item.dragging {
      opacity: 0.5;
      border: 1.5px dashed #26b3a0;
    }
    .quick-entry-item.drag-over {
      border: 1.5px solid #26b3a0;
      background: #eaf3fb;
    }
    .quick-entry-item .icon {
      width: 48px;
      height: 48px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .quick-entry-item .label {
      font-size: 16px;
      color: #444;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 600;
    }
    .quick-entry-item.editing .remove-btn {
      display: block;
    }
    .remove-btn {
      display: none;
      position: absolute;
      top: 6px;
      right: 8px;
      background: #fff;
      border: none;
      color: #e57373;
      font-size: 16px;
      border-radius: 50%;
      cursor: pointer;
    }
    .quick-entry-item.editing .remove-btn {
      display: block;
    }
    .home-page { padding: 0; }
    .home-layout { display: flex; gap: 16px; }
    .home-main { flex: 2; display: flex; flex-direction: column; gap: 16px; }
    .home-side { flex: 1; display: flex; flex-direction: column; gap: 16px; }
    .home-section { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(33,118,199,0.06); overflow: hidden; }
    .section-header { display: flex; align-items: center; font-size: 18px; font-weight: 500; padding: 12px 20px; }
    .section-header svg { margin-right: 8px; }
    .section-list { margin: 0; padding: 12px 20px 12px 38px; font-size: 15px; color: #185a99; list-style: disc; }
    .section-date { margin-left: auto; font-size: 15px; color: var(--theme-topbar-font); font-weight: 400; }
    .quick-actions-add button {
      background: #2176c7;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 7px 18px;
      font-size: 15px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.18s;
    }
    .quick-actions-add button:hover {
      background: #185a99;
    }

    /* Custom Multi-select Dropdown */
    .custom-multi-select {
        position: relative;
    }
    .custom-multi-select .select-box {
        display: flex;
        align-items: center;
        border: 1.2px solid #c0d3eb;
        border-radius: 4px;
        padding: 2px 8px;
        background: #f9fbfd;
        cursor: text;
        flex-wrap: wrap;
        min-height: 36px; /* Match input height */
    }
    .custom-multi-select .selected-options {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
        align-items: center;
    }
    .custom-multi-select .selected-option-tag {
        background-color: #e9ecef;
        color: #495057;
        border-radius: 4px;
        padding: 3px 8px;
        display: flex;
        align-items: center;
        font-size: 14px;
        line-height: 1.5;
    }
    .custom-multi-select .remove-tag {
        margin-left: 5px;
        cursor: pointer;
        font-weight: bold;
    }
    .custom-multi-select .search-box {
        flex-grow: 1;
    }
    .custom-multi-select .search-box input {
        border: none;
        outline: none;
        background: transparent;
        padding: 6px 0;
        width: 100%;
        min-width: 60px;
        font-size:15px;
    }
    .custom-multi-select .dropdown-icon {
        color: #6c757d;
        margin-left: 5px;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
    }
    .custom-multi-select.open .dropdown-icon {
        transform: rotate(180deg);
    }
    .custom-multi-select .search-icon {
        display: none;
    }
    .custom-multi-select .options-container {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #fff;
        border: 1px solid #c0d3eb;
        border-radius: 4px;
        margin-top: 4px;
        z-index: 1000;
        max-height: 200px;
        overflow-y: auto;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
    .custom-multi-select.open .options-container {
        display: block;
    }
    .custom-multi-select .option {
        padding: 10px 12px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 15px;
    }
    .custom-multi-select .option:hover {
        background-color: #f0f5fa;
    }
    .custom-multi-select .option.selected {
        background-color: #e3f2fd;
        font-weight: 500;
        color: #185a99;
    }
    .custom-multi-select .option .checkmark {
        visibility: hidden;
        color: #2176c7;
        font-size: 16px;
    }
    .custom-multi-select .option.selected .checkmark {
        visibility: visible;
    }
  </style>
</head>
<body>
  <div class="layout">
    <div class="topbar">
      <div class="topbar-left">
        <div class="logo" style="padding:0;background:transparent;border-radius:8px;width:120px;height:36px;display:flex;align-items:center;justify-content:center;">
          <img src="logo.png" alt="SGAI Logo" style="height:32px;max-width:100%;object-fit:contain;background:transparent;" />
        </div>
        <span class="topbar-title">主数据管理平台</span>
      </div>
      <div class="topbar-right">
        <span class="topbar-time" id="topbarTime"></span>
        <button class="icon-btn" title="消息" id="msgBtn">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none"><path d="M11 20c1.38 0 2.5-1.12 2.5-2.5h-5A2.5 2 0 0 0 11 20Zm7-5V10c0-3.07-1.64-5.64-5-6.32V3a2 2 0 1 0-4 0v.68C5.64 4.36 4 6.92 4 10v5l-1 1v1h16v-1l-1-1Z" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>
        </button>
        <button class="icon-btn" title="AI对话" id="aiBtn">
          <img src="panda.png" alt="AI助手" class="ai-avatar-icon" style="width:28px;height:28px;background:transparent;" />
        </button>
        <button class="icon-btn" title="查询" id="searchBtn">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none"><circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5" fill="none"/><line x1="15.2" y1="15.2" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
        <div class="user-info" id="userInfo">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none"><circle cx="11" cy="8" r="4" stroke="currentColor" stroke-width="1.5" fill="none"/><path d="M4 18c0-2.5 3-4 7-4s7 1.5 7 4" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>
          管理员
          <div class="user-dropdown" id="userDropdown">
            <div class="user-dropdown-item">个人信息</div>
            <div class="user-dropdown-item">修改密码</div>
            <div class="user-dropdown-item">退出登录</div>
          </div>
        </div>
        <button class="icon-btn" title="设置" id="settingBtn">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2h-2a2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 6.2 18.82l-.06-.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0-.33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.38 5.2l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9.2 4.6V3a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82 1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"></path>
          </svg>
        </button>
        <div class="theme-dropdown" id="themeDropdown">
          <div class="theme-dropdown-title">主题设置</div>
          <div class="theme-dropdown-list">
            <div class="theme-dropdown-item" data-theme="blue"><span class="theme-dot" style="background:#2176c7;"></span>默认科技蓝</div>
            <div class="theme-dropdown-item" data-theme="dark"><span class="theme-dot" style="background:#181c24;"></span>深色模式</div>
            <div class="theme-dropdown-item" data-theme="green"><span class="theme-dot" style="background:#2ecc71;"></span>森林绿色</div>
            <div class="theme-dropdown-item" data-theme="purple"><span class="theme-dot" style="background:#8e44ad;"></span>罗兰紫</div>
            <div class="theme-dropdown-item" data-theme="orange"><span class="theme-dot" style="background:#ff9800;"></span>活力橙色</div>
            <div class="theme-dropdown-item" data-theme="red"><span class="theme-dot" style="background:#e74c3c;"></span>中国红</div>
            <div class="theme-dropdown-item" data-theme="gray"><span class="theme-dot" style="background:#7f8c8d;"></span>中性灰色</div>
          </div>
        </div>
      </div>
    </div>
    <div class="main">
      <nav class="sidebar">
        <!-- 侧边栏内容 -->
        <ul class="menu" id="mainMenu">
          <!-- 将常用菜单改为首页，并去掉收藏相关内容 -->
          <li class="menu-item active" id="homeMenu">
            <div class="menu-item-header">
              <span class="menu-item-icon">
                <!-- 更现代的Home图标 -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M4 12L12 4l8 8"/>
                  <rect x="6" y="12" width="12" height="8" rx="2"/>
                </svg>
              </span>
              <span>首页</span>
            </div>
          </li>
          <li class="menu-item" id="dashboardMenu">
            <div class="menu-item-header">
              <span class="menu-item-icon">
                <!-- 管理驾驶舱图标 -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                  <line x1="9" y1="9" x2="9" y2="9"/>
                  <line x1="15" y1="9" x2="15" y2="9"/>
                  <line x1="9" y1="15" x2="9" y2="15"/>
                  <line x1="15" y1="15" x2="15" y2="15"/>
                </svg>
              </span>
              <span>管理驾驶舱</span>
            </div>
          </li>
          <li class="menu-item" data-menu-id="data-standard-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Standard Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book"><path d="M4 19.5V10a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v9.5a2.5 2.5 0 0 1-5 0A2.5 2.5 0 0 1 12 19.5a2.5 2.5 0 0 1-5 0A2.5 2.5 0 0 1 4 19.5z"></path></svg>
              </span>
              <span>数据标准管理</span>
              <span class="favorite-icon" data-menu-id="data-standard-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-content="model-query" data-url="model_query.html">数据模型管理</li>
              <li class="submenu-item" data-content="config-transfer" data-url="modal_config_transfer.html">配置迁移</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="model-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="4"/><path d="M8 8h8v8H8z"/></svg>
              </span>
              <span>模型管理(补充）</span>
              <span class="favorite-icon" data-menu-id="model-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-content="model-compare" data-url="modal_compare.html">模型版本比较</li>
              <li class="submenu-item" data-content="model-detail" data-url="modal_detail.html">模型详情查看</li>
              <li class="submenu-item" data-content="model-add" data-url="modal_detail_new.html">数据模型新增</li>
              <li class="submenu-item" data-content="condition-new" data-url="condition_new.html">筛选条件</li>
              <li class="submenu-item" data-content="expression" data-url="expression.html">表达式</li>
              <li class="submenu-item" data-content="business-rule" data-url="businessrule.html">业务规则</li>
              <li class="submenu-item" data-content="data-coderule" data-url="data_coderule.html">编码规则</li>
              <li class="submenu-item" data-content="page-setup" data-url="page_setup.html">页面布局配置</li>
              <li class="submenu-item" data-content="page-setup-tree" data-url="page_setup_tree.html">引用分类页面布局</li>
              <li class="submenu-item" data-content="data-preview" data-url="data_preview.html">布局预览</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-info-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Information Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><line x1="16" y1="21" x2="8" y2="21"></line></svg>
              </span>
              <span>数据信息管理</span>
              <span class="favorite-icon" data-menu-id="data-info-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-item-id="degree">学位</li>
              <li class="submenu-item" data-item-id="vendor">供应商管理</li>
              <li class="submenu-item" data-content="accounting-subject" data-url="Classification.html">会计科目</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-database"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg>
              </span>
              <span>数据管理（补充）</span>
              <span class="favorite-icon" data-menu-id="data-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-content="data-compare" data-url="data_compare.html">数据版本比较</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-flow-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Flow Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-branch"><line x1="6" y1="3" x2="6" y2="15"></line><circle cx="18" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><path d="M18 9a9 9 0 0 1-9 9"></path></svg>
              </span>
              <span>数据流程管理</span>
              <span class="favorite-icon" data-menu-id="data-flow-management">★</span>
            </div>
            <ul class="submenu">
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-quality-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Quality Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
              </span>
              <span>数据质量管理</span>
              <span class="favorite-icon" data-menu-id="data-quality-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-content="quality-analysis" data-url="quality_analysis.html">数据质量看板</li>
              <li class="submenu-item" data-content="data-source" data-url="data_source.html">数据源管理</li>
              <li class="submenu-item" data-content="data-set" data-url="data_set.html">数据集管理</li>
              <li class="submenu-item" data-content="quality-rule" data-url="quality_rule.html">质检规则管理</li>
                              <li class="submenu-item" data-content="quality-task" data-url="quality_task.html">质量检查任务</li>
                <li class="submenu-item" data-content="quality-report" data-url="quality_report.html">质检任务报告</li>
                <li class="submenu-item" data-content="quality-data" data-url="quality_data.html">质检异常数据</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-cleansing-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Cleansing Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
              </span>
              <span>数据清洗管理</span>
              <span class="favorite-icon" data-menu-id="data-cleansing-management">★</span>
            </div>
            <ul class="submenu">
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-service-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for Data Service Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-server"><rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect><line x1="6" y1="6" x2="6" y2="6"></line><line x1="6" y1="18" x2="6" y2="18"></line></svg>
              </span>
              <span>数据服务管理</span>
              <span class="favorite-icon" data-menu-id="data-service-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-content="business-system" data-url="business_system.html">业务系统</li>
              <li class="submenu-item" data-item-id="receive-config">接收服务配置</li>
              <li class="submenu-item" data-item-id="receive-log">接收服务日志</li>
              <li class="submenu-item" data-item-id="push-config">推送服务配置</li>
              <li class="submenu-item" data-item-id="push-log">推送服务日志</li>
              <li class="submenu-item" data-item-id="filter-config">筛选配置</li>
                                      <li class="submenu-item" data-content="query-service-config" data-url="data_service_list.html">查询服务配置</li>
              <li class="submenu-item" data-content="query-service-log" data-url="data_service_log.html">查询服务日志</li>
              <li class="submenu-item" data-content="smart-service" data-url="smart_service.html">智能服务管理</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="data-analysis-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trending-up"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>
              </span>
              <span>数据分析管理</span>
              <span class="favorite-icon" data-menu-id="data-analysis-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-item-id="cockpit">管理驾驶舱</li>
            </ul>
          </li>
          <li class="menu-item" data-menu-id="system-management">
            <div class="menu-item-header">
              <span class="favorite-arrow"></span>
              <span class="menu-item-icon">
                <!-- Icon for System Management -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
              </span>
              <span>系统管理</span>
              <span class="favorite-icon" data-menu-id="system-management">★</span>
            </div>
            <ul class="submenu">
              <li class="submenu-item" data-item-id="sys-dict">系统字典</li>
              <li class="submenu-item" data-content="data-standard" data-url="data_standard.html">数据元标准</li>
              <li class="submenu-item" data-item-id="notice">通知公告管理</li>
              <li class="submenu-item" data-content="attachmant" data-url="attachmant.html">批量附件上传</li>
            </ul>
          </li>
        </ul>
      </nav>
      <div class="content" id="mainContent">
        <!-- 主页内容等原有内容 -->
        <div id="homePage">
        </div>
      </div>
    </div>
  </div>
  <!-- AI对话抽屉 -->
  <div class="drawer-mask" id="drawerMask">
    <div class="drawer" id="drawerBox">
      <div class="drawer-header" style="padding:14px 20px; font-size:16px; font-weight:600; color:#333; border-bottom:1px solid #e3eaf3; display:flex; align-items:center; justify-content:space-between; background:#fff;">
        <div style="display:flex; align-items:center; gap:10px;">
          <img src="panda.png" alt="AI Assistant Logo" style="width:28px; height:28px; background:transparent;">
          <span style="font-size:16px; font-weight:600; color:#333;">AI助手</span>
        </div>
        <button style="background:none; border:none; font-size:22px; color:#999; cursor:pointer;" onclick="closeDrawer()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="drawer-content" id="drawerContent" style="display:flex;flex-direction:column;height:100%;padding:0;background:#f8fbff;">
        <!-- Logo and Welcome Message -->
        <div style="text-align:center; padding:100px 24px 20px;">
          <img src="AIlogo.png" alt="SGAI Logo" style="width:180px;height:auto;object-fit:contain; margin: 0 auto; display: block;" />
        </div>
        <div style="text-align:center; padding:0 24px 20px; color:#333; font-size:20px; font-weight:600;">你好，我是首自信智能AI助手，请问有什么可以帮助你的？</div>

        <!-- Chat History -->
        <div id="chatHistory" style="flex:1;overflow-y:auto;padding:0 24px 12px 24px;display:flex;flex-direction:column;gap:16px;"></div>

        <!-- Footer Input Area -->
        <div class="drawer-footer" style="padding:16px 24px; background:#fff; border-top:1px solid #e3eaf3;">
          <div style="background:#f8fbff; border:1px solid #e3eaf3; border-radius:28px; padding:12px 20px; display:flex; flex-direction:column; gap:8px; box-shadow:0 1px 4px rgba(33,118,199,0.08);">
            <!-- Input Field Container -->
            <div style="position:relative; display:flex; align-items:center; width:100%;">
              <input type="text" placeholder="搜资料、提问题、找答案" id="aiInput" style="flex:1; border:none; outline:none; font-size:16px; background:transparent; color:#333; height:40px; padding-right:50px;">
              <!-- Submit Button inside Input Field (bottom-right) -->
              <button style="background:#2176c7; border:none; border-radius:50%; width:48px; height:48px; display:flex; justify-content:center; align-items:center; cursor:pointer; box-shadow:0 2px 6px rgba(33,118,199,0.3); position:absolute; right:0px; bottom:2px;" onclick="sendAIMessage()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="12" y1="19" x2="12" y2="5"></line>
                  <polyline points="5 12 12 5 19 12"></polyline>
                </svg>
              </button>
            </div>

            <!-- Action Buttons Row -->
            <div style="display:flex; flex-wrap:wrap; gap:8px; justify-content:flex-start; padding-top:4px;">
              <!-- "深度搜索" Button -->
              <button style="background:#f0f6fd; border:1px solid #c0d3eb; padding:6px 14px; border-radius:20px; font-size:14px; color:#2176c7; cursor:pointer; display:flex; align-items:center; gap:4px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#2176c7" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 16V9M9 9l3-3 3 3"></path><circle cx="12" cy="18" r="1"></circle></svg>
                深度搜索
              </button>
              <!-- Microphone Icon -->
              <button style="background:none; border:none; font-size:20px; color:#666; cursor:pointer; padding:0 4px;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                  <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                  <line x1="12" y1="19" x2="12" y2="23"></line>
                  <line x1="8" y1="23" x2="16" y2="23"></line>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- 搜索弹窗 -->
  <div id="searchModalMask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.18);z-index:4000;align-items:center;justify-content:center;">
    <div id="searchModal" style="background:#fff;border-radius:14px;box-shadow:0 4px 24px rgba(33,118,199,0.13);padding:32px 32px 28px 32px;min-width:320px;max-width:90vw;display:flex;flex-direction:column;align-items:center;">
      <div style="font-size:20px;font-weight:600;color:#2176c7;margin-bottom:18px;display:flex;align-items:center;gap:8px;">
        <svg width="22" height="22" viewBox="0 0 22 22" fill="none"><circle cx="10" cy="10" r="7" stroke="#2176c7" stroke-width="1.5" fill="none"/><line x1="15.2" y1="15.2" x2="20" y2="20" stroke="#2176c7" stroke-width="1.5" stroke-linecap="round"/></svg>
        站内搜索
      </div>
      <input id="searchInput" type="text" placeholder="请输入关键字..." style="width:320px;max-width:70vw;padding:12px 18px;font-size:17px;border:1.5px solid #c0d3eb;border-radius:8px;outline:none;transition:border 0.2s;" autofocus />
      <div style="margin-top:18px;display:flex;gap:18px;">
        <button id="searchSubmitBtn" style="background:#2176c7;color:#fff;padding:8px 32px;border:none;border-radius:6px;font-size:16px;">搜索</button>
        <button id="searchCloseBtn" style="background:#eaf3fb;color:#2176c7;padding:8px 32px;border:none;border-radius:6px;font-size:16px;">关闭</button>
      </div>
    </div>
  </div>
  <!-- 新增弹窗（完整表单） -->
  <div id="noticeAddModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:2000;align-items:center;justify-content:center;">
    <div class="modal-content" style="background:#fff;border-radius:8px;max-width:900px;width:90vw;max-height:90vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
      <div style="background:#185a99;color:#fff;font-size:20px;font-weight:500;padding:16px 24px;border-radius:8px 8px 0 0;">文件添加 <span style='position:absolute;right:24px;top:16px;cursor:pointer;font-size:24px;' id="noticeAddClose">×</span></div>
      <form id="noticeAddForm" style="padding:24px;display:flex;flex-direction:column;gap:18px;">
        <div style="display:flex;align-items:center;gap:12px;">
          <label style="width:100px;">文件标题<span style="color:red">*</span>：</label>
          <input type="text" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;" required />
        </div>
        <div style="display:flex;align-items:center;gap:12px;">
          <label style="width:100px;">文件分类<span style="color:red">*</span>：</label>
          <select id="noticeFileCategory" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;">
            <option>规章制度</option>
            <option>标准及运维细则</option>
            <option>通知公告</option>
            <option>友情链接</option>
          </select>
        </div>
        <div id="noticeFileUploadRow" style="display:flex;align-items:center;gap:12px;">
          <label style="width:100px;">上传文件<span style="color:red">*</span>：</label>
          <input type="file" style="flex:1;" />
        </div>
        <div id="noticeLinkRow" style="display:none;flex-direction:column;gap:12px;">
          <div style="display:flex;align-items:center;gap:12px;">
            <label style="width:100px;">链接地址<span style='color:red'>*</span>：</label>
            <input type="url" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;" placeholder="请输入链接地址" />
          </div>
          <div style="display:flex;align-items:center;gap:12px;">
            <label style="width:100px;">链接图标：</label>
            <input type="file" accept="image/*" style="flex:1;" />
          </div>
        </div>
        <!-- SSO Advanced Config -->
        <div id="ssoConfigSection" style="display:none; flex-direction:column; gap:12px; border-top: 1px solid #f0f0f0; padding-top: 18px; margin-top: 6px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div style="font-size: 16px; font-weight: 500; color: #333;">单点登录配置</div>
                    <div style="font-size: 14px; color: #888; margin-top: 4px;">为外部链接配置SSO认证</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="ssoAdvancedToggle">
                    <span class="slider round"></span>
                </label>
            </div>
            <div id="ssoAdvancedPanel" style="display:none; border:1px solid #e3eaf3; border-radius:4px; padding:16px;">
                 <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 16px 24px;">
                    <div>
                        <label style="display:block; margin-bottom:6px; font-weight:500;">认证URL</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="https://auth.example.com/oauth/authorize">
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:6px; font-weight:500;">Token URL</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="https://auth.example.com/oauth/token">
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:6px; font-weight:500;">Client ID</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="your_client_id">
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:6px; font-weight:500;">Client Secret</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="your_client_secret">
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:6px; font-weight:500;">Scope</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="e.g., openid profile email">
                    </div>
                     <div>
                        <label style="display:block; margin-bottom:6px; font-weight:500;">Redirect URI</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="e.g., https://yourapp.com/callback">
                    </div>
                    <div style="grid-column: 1 / span 2;">
                        <label style="display:block; margin-bottom:6px; font-weight:500;">鉴权方法</label>
                        <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="请输入鉴权方法，如Basic、Bearer等">
                    </div>
                 </div>
            </div>
        </div>
        <div style="display:flex;align-items:flex-start;gap:12px;">
          <label style="width:100px;">权限范围：</label>
          <input id="noticePermInput" type="text" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;background:#f8fbff;cursor:pointer;" placeholder="点击选择权限范围" readonly />
        </div>
        <div style="display:flex;align-items:flex-start;gap:12px;">
          <label style="width:100px;">发布内容：</label>
          <div style="flex:1;">
            <div style="background:#f8fbff;border:1px solid #e3eaf3;border-radius:4px;padding:8px 0 0 8px;min-height:120px;">
              <div style="margin-bottom:8px;">
                <button type="button" style="font-weight:bold;">B</button>
                <button type="button" style="font-style:italic;">I</button>
                <button type="button" style="text-decoration:underline;">U</button>
              </div>
              <textarea style="width:100%;min-height:80px;border:none;outline:none;background:transparent;"></textarea>
            </div>
          </div>
        </div>
        <div style="display:flex;justify-content:flex-end;gap:18px;margin-top:18px;">
          <button type="button" style="background:#185a99;color:#fff;padding:8px 32px;border:none;border-radius:4px;font-size:16px;">发布</button>
          <button type="button" style="background:#e3eaf3;color:#185a99;padding:8px 32px;border:none;border-radius:4px;font-size:16px;">保存</button>
          <button type="button" id="noticeAddClose2" style="background:#e3eaf3;color:#185a99;padding:8px 32px;border:none;border-radius:4px;font-size:16px;">取消</button>
        </div>
      </form>
    </div>
  </div>
  <!-- 权限范围选择弹窗 -->
  <div id="permSelectModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:2100;align-items:center;justify-content:center;">
    <div class="modal-content" style="background:#fff;border-radius:8px;max-width:600px;width:90vw;max-height:80vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
      <div style="background:#2176c7;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">选择权限范围 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="permSelectClose">×</span></div>
      <div style="padding:20px;">
        <div style="display:flex;gap:12px;margin-bottom:16px;">
          <button type="button" class="perm-tab active" data-tab="user">人员</button>
          <button type="button" class="perm-tab" data-tab="org">组织架构</button>
          <button type="button" class="perm-tab" data-tab="post">岗位</button>
        </div>
        <div id="permTabContent">
          <div class="perm-list" data-tab="user">
            <label><input type="checkbox" value="张三"> 张三</label><br/>
            <label><input type="checkbox" value="李四"> 李四</label><br/>
            <label><input type="checkbox" value="王五"> 王五</label><br/>
          </div>
          <div class="perm-list" data-tab="org" style="display:none;">
            <label><input type="checkbox" value="市场部"> 市场部</label><br/>
            <label><input type="checkbox" value="财务部"> 财务部</label><br/>
            <label><input type="checkbox" value="研发部"> 研发部</label><br/>
          </div>
          <div class="perm-list" data-tab="post" style="display:none;">
            <label><input type="checkbox" value="经理"> 经理</label><br/>
            <label><input type="checkbox" value="专员"> 专员</label><br/>
            <label><input type="checkbox" value="实习生"> 实习生</label><br/>
          </div>
        </div>
        <div style="display:flex;justify-content:flex-end;gap:18px;margin-top:18px;">
          <button type="button" id="permSelectOk" style="background:#2176c7;color:#fff;padding:8px 32px;border:none;border-radius:4px;font-size:15px;">确定</button>
          <button type="button" id="permSelectCancel" style="background:#e3eaf3;color:#2176c7;padding:8px 32px;border:none;border-radius:4px;font-size:15px;">取消</button>
        </div>
      </div>
    </div>
  </div>
  <!-- 详情弹窗 -->
  <div id="noticeDetailModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
    <div class="modal-content" style="background:#fff;border-radius:8px;max-width:600px;width:90vw;max-height:80vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
      <div style="background:#2176c7;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">公告详情 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="noticeDetailClose">×</span></div>
      <div id="noticeDetailContent" style="padding:24px;font-size:16px;color:#222;">这里显示公告详情内容</div>
    </div>
  </div>
  <!-- 编辑弹窗 -->
  <div id="noticeEditModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
    <div class="modal-content" style="background:#fff;border-radius:8px;max-width:600px;width:90vw;max-height:80vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
      <div style="background:#2176c7;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">编辑公告 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="noticeEditClose">×</span></div>
      <div style="padding:24px;">（此处为编辑表单，静态展示）</div>
    </div>
  </div>
  <!-- 删除确认弹窗 -->
  <div id="noticeDelModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
    <div class="modal-content" style="background:#fff;border-radius:8px;max-width:400px;width:90vw;max-height:60vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
      <div style="background:#f5222d;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">删除确认 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="noticeDelClose">×</span></div>
      <div style="padding:24px;">确定要删除该公告吗？</div>
      <div style="display:flex;justify-content:flex-end;gap:18px;margin:18px 0 0 0;">
        <button class="btn-main" id="noticeDelOk">确定</button>
        <button class="btn-line" id="noticeDelCancel">取消</button>
      </div>
    </div>
  </div>
  <!-- 人员选择弹窗（表格风格） -->
  <div id="userSelectModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
    <div class="modal-content" style="background:#fff;border-radius:8px;max-width:900px;width:90vw;max-height:80vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
      <div style="background:#2176c7;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">选择人员 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="userSelectClose">×</span></div>
      <div style="padding:20px;">
        <div style="display:flex;gap:8px;margin-bottom:10px;align-items:center;">
          <input type="text" id="userSearchInput" placeholder="用户名称/编码" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;">
          <button id="userSearchBtn" style="background:#2176c7;color:#fff;padding:6px 18px;border:none;border-radius:4px;font-size:15px;">查询</button>
        </div>
        <div style="overflow:auto;max-height:340px;">
          <table class="model-table" style="min-width:700px;">
            <thead>
              <tr>
                <th style="width:40px;"><input type="checkbox" id="userSelectAll"></th>
                <th>用户编码</th>
                <th>用户名</th>
                <th>单位名称</th>
                <th>创建人编码</th>
                <th style="min-width:133px;width:133px;">创建人名称</th>
                <th>创建时间</th>
              </tr>
            </thead>
            <tbody id="userTableBody"></tbody>
          </table>
        </div>
        <div style="display:flex;justify-content:flex-end;gap:18px;margin-top:18px;">
          <button type="button" id="userSelectOk" style="background:#2176c7;color:#fff;padding:8px 32px;border:none;border-radius:4px;font-size:15px;">确定</button>
          <button type="button" id="userSelectCancel" style="background:#e3eaf3;color:#2176c7;padding:8px 32px;border:none;border-radius:4px;font-size:15px;">取消</button>
        </div>
      </div>
    </div>
  </div>
  <script>
    // 顶部时间显示
    function updateTopbarTime() {
      const now = new Date();
      const weekMap = ['日','一','二','三','四','五','六'];
      const y = now.getFullYear();
      const m = (now.getMonth() + 1).toString().padStart(2, '0');
      const d = now.getDate().toString().padStart(2, '0');
      const h = now.getHours().toString().padStart(2, '0');
      const min = now.getMinutes().toString().padStart(2, '0');
      const s = now.getSeconds().toString().padStart(2, '0');
      const week = weekMap[now.getDay()];
      document.getElementById('topbarTime').textContent = `${y}-${m}-${d} 星期${week} ${h}:${min}:${s}`;
    }
    setInterval(updateTopbarTime, 1000);
    updateTopbarTime();

    // 收藏功能逻辑
    const favoritedItemsList = document.getElementById('favoritedItemsList');

    function loadFavorites() {
      const favoritedItems = JSON.parse(localStorage.getItem('favoritedItems') || '[]');
      if (favoritedItemsList) {
          favoritedItemsList.innerHTML = ''; // Clear existing items
      }

      document.querySelectorAll('.menu-item').forEach(item => {
        const menuId = item.dataset.menuId;
        const favoriteIcon = item.querySelector('.favorite-icon');
        if (favoriteIcon) {
          if (favoritedItems.includes(menuId)) {
            item.classList.add('is-favorited-and-hidden');
            favoriteIcon.classList.add('favorited');
          } else {
            item.classList.remove('is-favorited-and-hidden');
            favoriteIcon.classList.remove('favorited');
          }
        }
      });

      favoritedItems.forEach(menuId => {
        const originalMenuItem = document.querySelector(`.menu-item[data-menu-id="${menuId}"]`);
        if (originalMenuItem && favoritedItemsList) {
          const submenuItems = originalMenuItem.querySelectorAll('.submenu-item');
          submenuItems.forEach(subItem => {
            const clonedSubItem = subItem.cloneNode(true);
            const wrapperDiv = document.createElement('div');
            wrapperDiv.style.cssText = 'display:flex; align-items:center; justify-content:space-between; width:100%;';
            const spanText = document.createElement('span');
            spanText.textContent = clonedSubItem.textContent;
            spanText.style.flexGrow = '1';
            const clonedFavoriteIcon = document.createElement('span');
            clonedFavoriteIcon.className = 'favorite-icon';
            clonedFavoriteIcon.textContent = '★';
            clonedFavoriteIcon.setAttribute('data-menu-id', menuId);
            wrapperDiv.appendChild(spanText);
            wrapperDiv.appendChild(clonedFavoriteIcon);
            clonedSubItem.innerHTML = '';
            clonedSubItem.appendChild(wrapperDiv);
            clonedSubItem.dataset.url = subItem.dataset.url;
            clonedFavoriteIcon.onclick = (event) => {
              event.stopPropagation();
              toggleFavorite(menuId);
            };
            clonedSubItem.onclick = () => {
              const url = clonedSubItem.dataset.url;
              if (url) {
                document.getElementById('contentFrame').src = url;
                document.querySelectorAll('.menu-item, .submenu-item').forEach(item => item.classList.remove('active'));
                clonedSubItem.classList.add('active');
                const parentMenuItem = clonedSubItem.closest('.menu-item');
                if (parentMenuItem && !parentMenuItem.classList.contains('expanded')) {
                  parentMenuItem.classList.add('expanded');
                }
              }
            };
            favoritedItemsList.appendChild(clonedSubItem);
          });
        }
      });
    }

    function toggleFavorite(menuId) {
      let favoritedItems = JSON.parse(localStorage.getItem('favoritedItems') || '[]');
      const menuItem = document.querySelector(`.menu-item[data-menu-id="${menuId}"]`);
      const favoriteIconMain = menuItem ? menuItem.querySelector('.favorite-icon') : null;

      if (favoritedItems.includes(menuId)) {
        favoritedItems = favoritedItems.filter(id => id !== menuId);
        if (menuItem) menuItem.classList.remove('is-favorited-and-hidden');
        if (favoriteIconMain) favoriteIconMain.classList.remove('favorited');
      } else {
        favoritedItems.push(menuId);
        if (menuItem) menuItem.classList.add('is-favorited-and-hidden');
        if (favoriteIconMain) favoriteIconMain.classList.add('favorited');
      }
      localStorage.setItem('favoritedItems', JSON.stringify(favoritedItems));
      loadFavorites();
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.menu-item-header').forEach(header => {
        const arrow = header.querySelector('.favorite-arrow');
        if (arrow && header.firstChild !== arrow) {
          header.insertBefore(arrow, header.firstChild);
        }
      });

      loadFavorites();

      const logo = document.querySelector('.logo');
      if (logo) {
        logo.style.cursor = 'pointer';
        logo.onclick = function() {
          document.querySelectorAll('.menu-item, .submenu-item').forEach(i => i.classList.remove('active'));
          const homeMenu = document.getElementById('homeMenu');
          if(homeMenu) homeMenu.classList.add('active');
          document.getElementById('mainContent').innerHTML = `<iframe src="main.html" style="width:100%; height:calc(100% - 5px); border:none; background: #fdfdfd;"></iframe>`;
        };
      }

      document.getElementById('mainContent').innerHTML = `<iframe src="main.html" style="width:100%; height:calc(100% - 5px); border:none; background: #fdfdfd;"></iframe>`;
    });

    const menuItems = document.querySelectorAll('.menu-item');
    menuItems.forEach(item => {
      const header = item.querySelector('.menu-item-header');
      if (header) {
        header.onclick = function(e) {
          document.querySelectorAll('.menu-item, .submenu-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');

          if (item.id === 'homeMenu') {
            document.getElementById('mainContent').innerHTML = `<iframe src="main.html" style="width:100%; height:calc(100% - 5px); border:none; background: #fdfdfd;"></iframe>`;
            menuItems.forEach(i => {
              if (i.id !== 'homeMenu') i.classList.remove('open');
            });
            return;
          }

          if (item.id === 'dashboardMenu') {
            document.getElementById('mainContent').innerHTML = `<iframe src="dashboard.html" style="width:100%; height:calc(100% - 5px); border:none; background: #fdfdfd;"></iframe>`;
            menuItems.forEach(i => {
              if (i.id !== 'dashboardMenu') i.classList.remove('open');
            });
            return;
          }

          if (e.target.classList.contains('favorite-icon')) {
             item.classList.add('active');
             return;
          }

          const isOpen = item.classList.contains('open');
          menuItems.forEach(i => {
            if (i !== item) i.classList.remove('open');
          });
          item.classList.toggle('open');
        };
      }
    });

    const submenuItems = document.querySelectorAll('.submenu-item');
    submenuItems.forEach(item => {
      item.onclick = function(e) {
        if (e.target.classList.contains('favorite-icon')) return;

        document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
        item.closest('.menu-item').classList.add('active');
        
        submenuItems.forEach(i => i.classList.remove('active'));
        this.classList.add('active');
        e.stopPropagation();

        if (this.dataset.itemId === 'cockpit') showCockpitPage();
        else if (this.dataset.itemId === 'notice') showNoticeTable();
        else if (this.dataset.itemId === 'filter-config') showConditionPage();
        else if (this.dataset.itemId === 'receive-config') document.getElementById('mainContent').innerHTML = `<iframe src="data_receive_list.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        else if (this.dataset.itemId === 'push-config') document.getElementById('mainContent').innerHTML = `<iframe src="data_send_list.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        else if (this.dataset.itemId === 'push-log') document.getElementById('mainContent').innerHTML = `<iframe src="data_send_log.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        else if (this.dataset.itemId === 'degree') {
          window.open('degree.html', '_blank');
        }
        else if (this.dataset.itemId === 'vendor') {
          window.open('vendor.html', '_blank');
        }
        else if (this.dataset.itemId === 'sys-dict') {
          document.getElementById('mainContent').innerHTML = `<iframe src="data_dict.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }

        else if (this.dataset.itemId === 'receive-log') document.getElementById('mainContent').innerHTML = `<iframe src="data_receive_log.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        else if (this.dataset.content === 'query-service-config') {
          document.getElementById('mainContent').innerHTML = `<iframe src="data_service_list.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
        else if (this.dataset.content === 'query-service-log') {
          document.getElementById('mainContent').innerHTML = `<iframe src="data_service_log.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
        else if (this.dataset.content === 'data-source') {
          document.getElementById('mainContent').innerHTML = `<iframe src="data_source.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
        else if (this.dataset.content === 'data-set') {
          document.getElementById('mainContent').innerHTML = `<iframe src="data_set.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
        else if (this.dataset.content === 'quality-rule') {
          document.getElementById('mainContent').innerHTML = `<iframe src="quality_rule.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
        else if (this.dataset.content === 'quality-task') {
          document.getElementById('mainContent').innerHTML = `<iframe src="quality_task.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
        else if (this.dataset.content === 'quality-report') {
          document.getElementById('mainContent').innerHTML = `<iframe src="quality_report.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
        }
                  else if (this.dataset.content === 'quality-data') {
            document.getElementById('mainContent').innerHTML = `<iframe src="quality_data.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          }
          else if (this.dataset.content === 'quality-analysis') {
            document.getElementById('mainContent').innerHTML = `<iframe src="quality_analysis.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          }
        else {
          const content = this.dataset.content;
          if (content === 'model-query') {
            document.getElementById('mainContent').innerHTML = `<iframe src="datamoudual.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'model-compare') {
            document.getElementById('mainContent').innerHTML = `<iframe src="modal_compare.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'model-detail') {
            document.getElementById('mainContent').innerHTML = `<iframe src="modal_detail.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'model-add') {
            document.getElementById('mainContent').innerHTML = `<iframe src="modal_detail_new.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'data-standard') {
            document.getElementById('mainContent').innerHTML = `<iframe src="data_standard.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'condition-new') {
            document.getElementById('mainContent').innerHTML = `<iframe src="condition_new.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'expression') {
            document.getElementById('mainContent').innerHTML = `<iframe src="expression.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'business-rule') {
            document.getElementById('mainContent').innerHTML = `<iframe src="businessrule.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'data-coderule') {
            document.getElementById('mainContent').innerHTML = `<iframe src="data_coderule.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'page-setup') {
            document.getElementById('mainContent').innerHTML = `<iframe src="page_setup.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'page-setup-tree') {
            document.getElementById('mainContent').innerHTML = `<iframe src="page_setup_tree.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'data-preview') {
            document.getElementById('mainContent').innerHTML = `<iframe src="data_preview.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'data-compare') {
            document.getElementById('mainContent').innerHTML = `<iframe src="data_compare.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'accounting-subject') {
            window.open('Classification.html', '_blank');
          } else if (content === 'business-system') {
            document.getElementById('mainContent').innerHTML = `<iframe src="business_system.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'config-transfer') {
            document.getElementById('mainContent').innerHTML = `<iframe src="modal_config_transfer.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'smart-service') {
            document.getElementById('mainContent').innerHTML = `<iframe src="smart_service.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else if (content === 'attachmant') {
            document.getElementById('mainContent').innerHTML = `<iframe src="attachmant.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>`;
          } else {
            document.getElementById('mainContent').innerHTML = document.getElementById('homePage').innerHTML;
          }
        }
      };
    });

    function showNoticeTable() {
      document.getElementById('mainContent').innerHTML = `
        <div class="notice-section">
          <!-- 查询区 -->
          <div class="query-bar" style="margin-bottom:0;display:flex;flex-direction:column;gap:0;align-items:flex-start;">
            <div style="display:flex;align-items:center;gap:18px 12px;flex-wrap:wrap;">
              <label>文件标题：</label>
              <input type="text" placeholder="请输入文件标题" style="width:120px;" />
              <label>文件分类：</label>
              <select style="width:110px;">
                <option value="">全部</option>
                <option>规章制度</option>
                <option>标准及运维细则</option>
                <option>通知公告</option>
                <option>友情链接</option>
              </select>
              <label>是否发布：</label>
              <select style="width:80px;">
                <option value="">全部</option>
                <option>是</option>
                <option>否</option>
              </select>
        </div>
            <div style="display:flex;align-items:center;gap:12px;margin-top:10px;">
              <label>创建时间：</label>
              <input type="date" style="width:120px;" />
              <span style="margin:0 4px;">至</span>
              <input type="date" style="width:120px;" />
            </div>
            <div style="display:flex;justify-content:flex-end;width:100%;margin-top:10px;">
              <button class="btn-main" style="min-width:72px;">查询</button>
              <button class="btn-line" style="min-width:72px;margin-left:10px;">重置</button>
            </div>
          </div>
          <!-- 操作区 -->
          <div class="action-bar" style="margin-bottom:10px;display:flex;gap:10px;">
            <button class="btn-main" id="noticeAddBtn"><span class="icon">＋</span> 新增</button>
            <button class="btn-line" id="noticePublishBtn">发布</button>
            <button class="btn-line" id="noticeForbidBtn">禁止</button>
            <button class="btn-line" id="noticeDeleteBtn">删除</button>
          </div>
          <!-- 列表区 -->
        <div class="table-wrap">
            <table class="model-table" style="min-width:800px;">
            <thead>
              <tr>
                  <th class="checkbox-cell" style="width:36px;"><input type="checkbox"></th>
                  <th style="width:180px;">文件标题</th>
                  <th style="width:120px;">文件分类</th>
                  <th style="width:80px;">是否发布</th>
                  <th style="width:170px;">创建时间</th>
                  <th style="width:90px;">创建人</th>
                  <th style="width:120px;text-align:center;">操作</th>
              </tr>
            </thead>
            <tbody>
                <tr>
                  <td class="checkbox-cell"><input type="checkbox"></td>
                  <td><a href="#" class="notice-title-link" data-title="外部链接">外部链接</a></td>
                  <td>友情链接</td>
                  <td>是</td>
                  <td>2025-06-11 13:32:01</td>
                  <td>admin</td>
                  <td class="center">
                    <div style="display:inline-flex;gap:16px;">
                      <button class="notice-edit-btn" style="background:none;border:none;color:#2176c7;cursor:pointer;font-size:15px;padding:0;">编辑</button>
                      <button class="notice-del-btn" style="background:none;border:none;color:#f5222d;cursor:pointer;font-size:15px;padding:0;">删除</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="checkbox-cell"><input type="checkbox"></td>
                  <td><a href="#" class="notice-title-link" data-title="2025年度公司考勤管理制度">2025年度公司考勤管理制度</a></td>
                  <td>规章制度</td>
                  <td>是</td>
                  <td>2025-06-11 13:30:34</td>
                  <td>admin</td>
                  <td class="center">
                    <div style="display:inline-flex;gap:16px;">
                      <button class="notice-edit-btn" style="background:none;border:none;color:#2176c7;cursor:pointer;font-size:15px;padding:0;">编辑</button>
                      <button class="notice-del-btn" style="background:none;border:none;color:#f5222d;cursor:pointer;font-size:15px;padding:0;">删除</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="checkbox-cell"><input type="checkbox"></td>
                  <td><a href="#" class="notice-title-link" data-title="2025新发布标准">2025新发布标准</a></td>
                  <td>标准及运维细则</td>
                  <td>是</td>
                  <td>2025-06-11 13:27:42</td>
                  <td>admin</td>
                  <td class="center">
                    <div style="display:inline-flex;gap:16px;">
                      <button class="notice-edit-btn" style="background:none;border:none;color:#2176c7;cursor:pointer;font-size:15px;padding:0;">编辑</button>
                      <button class="notice-del-btn" style="background:none;border:none;color:#f5222d;cursor:pointer;font-size:15px;padding:0;">删除</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="checkbox-cell"><input type="checkbox"></td>
                  <td><a href="#" class="notice-title-link" data-title="通知">通知</a></td>
                  <td>通知公告</td>
                  <td>是</td>
                  <td>2025-06-11 13:20:17</td>
                  <td>admin</td>
                  <td class="center">
                    <div style="display:inline-flex;gap:16px;">
                      <button class="notice-edit-btn" style="background:none;border:none;color:#2176c7;cursor:pointer;font-size:15px;padding:0;">编辑</button>
                      <button class="notice-del-btn" style="background:none;border:none;color:#f5222d;cursor:pointer;font-size:15px;padding:0;">删除</button>
                    </div>
                  </td>
                </tr>
            </tbody>
          </table>
        </div>
          <!-- 新增弹窗（完整表单） -->
        <div id="noticeAddModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:2000;align-items:center;justify-content:center;">
          <div class="modal-content" style="background:#fff;border-radius:8px;max-width:900px;width:90vw;max-height:90vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
            <div style="background:#185a99;color:#fff;font-size:20px;font-weight:500;padding:16px 24px;border-radius:8px 8px 0 0;">文件添加 <span style='position:absolute;right:24px;top:16px;cursor:pointer;font-size:24px;' id="noticeAddClose">×</span></div>
            <form id="noticeAddForm" style="padding:24px;display:flex;flex-direction:column;gap:18px;">
              <div style="display:flex;align-items:center;gap:12px;">
                <label style="width:100px;">文件标题<span style="color:red">*</span>：</label>
                <input type="text" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;" required />
              </div>
              <div style="display:flex;align-items:center;gap:12px;">
                <label style="width:100px;">文件分类<span style="color:red">*</span>：</label>
                <select id="noticeFileCategory" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;">
                  <option>规章制度</option>
                  <option>标准及运维细则</option>
                  <option>通知公告</option>
                  <option>友情链接</option>
                </select>
              </div>
              <div id="noticeFileUploadRow" style="display:flex;align-items:center;gap:12px;">
                <label style="width:100px;">上传文件<span style="color:red">*</span>：</label>
                <input type="file" style="flex:1;" />
              </div>
              <div id="noticeLinkRow" style="display:none;flex-direction:column;gap:12px;">
                <div style="display:flex;align-items:center;gap:12px;">
                  <label style="width:100px;">链接地址<span style='color:red'>*</span>：</label>
                  <input type="url" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;" placeholder="请输入链接地址" />
                </div>
                <div style="display:flex;align-items:center;gap:12px;">
                  <label style="width:100px;">链接图标：</label>
                  <input type="file" accept="image/*" style="flex:1;" />
                  </div>
                </div>
                <!-- SSO Advanced Config -->
                <div id="ssoConfigSection" style="display:none; flex-direction:column; gap:12px; border-top: 1px solid #f0f0f0; padding-top: 18px; margin-top: 6px;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <div style="font-size: 16px; font-weight: 500; color: #333;">单点登录配置</div>
                            <div style="font-size: 14px; color: #888; margin-top: 4px;">为外部链接配置SSO认证</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="ssoAdvancedToggle">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div id="ssoAdvancedPanel" style="display:none; border:1px solid #e3eaf3; border-radius:4px; padding:16px;">
                         <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 16px 24px;">
                            <div>
                                <label style="display:block; margin-bottom:6px; font-weight:500;">认证URL</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="https://auth.example.com/oauth/authorize">
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:6px; font-weight:500;">Token URL</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="https://auth.example.com/oauth/token">
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:6px; font-weight:500;">Client ID</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="your_client_id">
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:6px; font-weight:500;">Client Secret</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="your_client_secret">
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:6px; font-weight:500;">Scope</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="e.g., openid profile email">
                            </div>
                             <div>
                                <label style="display:block; margin-bottom:6px; font-weight:500;">Redirect URI</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="e.g., https://yourapp.com/callback">
                            </div>
                            <div style="grid-column: 1 / span 2;">
                                <label style="display:block; margin-bottom:6px; font-weight:500;">鉴权方法</label>
                                <input type="text" style="width:100%; box-sizing: border-box; padding:6px 10px; border:1px solid #ccc; border-radius:4px;" placeholder="请输入鉴权方法，如Basic、Bearer等">
                            </div>
                         </div>
                    </div>
                </div>
              <div style="display:flex;align-items:flex-start;gap:12px;">
                <label style="width:100px;">权限范围：</label>
                <input id="noticePermInput" type="text" style="flex:1;padding:6px 10px;border:1px solid #e3eaf3;border-radius:4px;background:#f8fbff;cursor:pointer;" placeholder="点击选择权限范围" readonly />
              </div>
              <div style="display:flex;align-items:flex-start;gap:12px;">
                <label style="width:100px;">发布内容：</label>
                <div style="flex:1;">
                  <div style="background:#f8fbff;border:1px solid #e3eaf3;border-radius:4px;padding:8px 0 0 8px;min-height:120px;">
                    <div style="margin-bottom:8px;">
                      <button type="button" style="font-weight:bold;">B</button>
                      <button type="button" style="font-style:italic;">I</button>
                      <button type="button" style="text-decoration:underline;">U</button>
                    </div>
                    <textarea style="width:100%;min-height:80px;border:none;outline:none;background:transparent;"></textarea>
                  </div>
                </div>
              </div>
              <div style="display:flex;justify-content:flex-end;gap:18px;margin-top:18px;">
                  <button type="button" style="background:#185a99;color:#fff;padding:8px 32px;border:none;border-radius:4px;font-size:16px;">发布</button>
                  <button type="button" style="background:#e3eaf3;color:#185a99;padding:8px 32px;border:none;border-radius:4px;font-size:16px;">保存</button>
                  <button type="button" id="noticeAddClose2" style="background:#e3eaf3;color:#185a99;padding:8px 32px;border:none;border-radius:4px;font-size:16px;">取消</button>
              </div>
            </form>
          </div>
        </div>
        </div>
        <!-- 详情弹窗 -->
        <div id="noticeDetailModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
          <div class="modal-content" style="background:#fff;border-radius:8px;max-width:600px;width:90vw;max-height:80vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
            <div style="background:#2176c7;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">公告详情 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="noticeDetailClose">×</span></div>
            <div id="noticeDetailContent" style="padding:24px;font-size:16px;color:#222;">这里显示公告详情内容</div>
              </div>
                </div>
        <!-- 编辑弹窗 -->
        <div id="noticeEditModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
          <div class="modal-content" style="background:#fff;border-radius:8px;max-width:600px;width:90vw;max-height:80vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
            <div style="background:#2176c7;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">编辑公告 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="noticeEditClose">×</span></div>
            <div style="padding:24px;">（此处为编辑表单，静态展示）</div>
                </div>
                </div>
        <!-- 删除确认弹窗 -->
        <div id="noticeDelModal" class="modal-mask" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
          <div class="modal-content" style="background:#fff;border-radius:8px;max-width:400px;width:90vw;max-height:60vh;overflow:auto;box-shadow:0 4px 24px rgba(33,118,199,0.13);position:relative;">
            <div style="background:#f5222d;color:#fff;font-size:18px;font-weight:500;padding:14px 20px;border-radius:8px 8px 0 0;">删除确认 <span style='position:absolute;right:20px;top:14px;cursor:pointer;font-size:22px;' id="noticeDelClose">×</span></div>
            <div style="padding:24px;">确定要删除该公告吗？</div>
            <div style="display:flex;justify-content:flex-end;gap:18px;margin:18px 0 0 0;">
              <button class="btn-main" id="noticeDelOk">确定</button>
              <button class="btn-line" id="noticeDelCancel">取消</button>
            </div>
          </div>
        </div>
      `;
      // 绑定弹窗关闭事件
      document.getElementById('noticeDetailClose').onclick = function() {
        document.getElementById('noticeDetailModal').style.display = 'none';
      };
      document.querySelectorAll('.notice-title-link').forEach(link => {
        link.onclick = function(e) {
          e.preventDefault();
          document.getElementById('noticeDetailContent').textContent = '这里显示公告详情内容：' + this.dataset.title;
          document.getElementById('noticeDetailModal').style.display = 'flex';
        };
      });
      document.querySelectorAll('.notice-edit-btn').forEach(btn => {
        btn.onclick = function() {
          document.getElementById('noticeEditModal').style.display = 'flex';
        };
      });
      document.getElementById('noticeEditClose').onclick = function() {
        document.getElementById('noticeEditModal').style.display = 'none';
      };
      document.querySelectorAll('.notice-del-btn').forEach(btn => {
        btn.onclick = function() {
          document.getElementById('noticeDelModal').style.display = 'flex';
        };
      });
      document.getElementById('noticeDelClose').onclick = function() {
        document.getElementById('noticeDelModal').style.display = 'none';
      };
      document.getElementById('noticeDelCancel').onclick = function() {
        document.getElementById('noticeDelModal').style.display = 'none';
      };
      document.getElementById('noticeDelOk').onclick = function() {
        document.getElementById('noticeDelModal').style.display = 'none';
        // 静态页面，无实际删除逻辑
      };
      // 新增按钮弹窗
      document.getElementById('noticeAddBtn').onclick = function() {
        document.getElementById('noticeAddModal').style.display = 'flex';
      };
      document.getElementById('noticeAddClose').onclick = function() {
        document.getElementById('noticeAddModal').style.display = 'none';
      };
      document.getElementById('noticeAddClose2').onclick = function() {
        document.getElementById('noticeAddModal').style.display = 'none';
      };
      // 权限范围弹窗相关JS
      const permInput = document.getElementById('noticePermInput');
      const permModal = document.getElementById('permSelectModal');
      const permClose = document.getElementById('permSelectClose');
      const permCancel = document.getElementById('permSelectCancel');
      const permOk = document.getElementById('permSelectOk');
      const permTabs = permModal.querySelectorAll('.perm-tab');
      const permLists = permModal.querySelectorAll('.perm-list');
      function openPermModal() { permModal.style.display = 'flex'; }
      function closePermModal() { permModal.style.display = 'none'; }
      permInput.onclick = openPermModal;
      permClose.onclick = closePermModal;
      permCancel.onclick = closePermModal;
      permOk.onclick = function() {
        let selected = [];
        permLists.forEach(list => {
          list.querySelectorAll('input[type=checkbox]:checked').forEach(cb => {
            selected.push(cb.value);
          });
        });
        permInput.value = selected.join(', ');
        closePermModal();
      };
      permTabs.forEach(tab => {
        tab.onclick = function() {
          permTabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          const tabName = this.getAttribute('data-tab');
          permLists.forEach(list => {
            list.style.display = list.getAttribute('data-tab') === tabName ? '' : 'none';
          });
        };
      });
      // 分类切换联动
      var categorySelect = document.getElementById('noticeFileCategory');
      var fileRow = document.getElementById('noticeFileUploadRow');
      var linkRow = document.getElementById('noticeLinkRow');
      var ssoConfigSection = document.getElementById('ssoConfigSection');
      var ssoAdvancedToggle = document.getElementById('ssoAdvancedToggle');
      var ssoAdvancedPanel = document.getElementById('ssoAdvancedPanel');

      if (categorySelect) {
      categorySelect.onchange = function() {
        if (categorySelect.value === '友情链接') {
          fileRow.style.display = 'none';
          linkRow.style.display = 'flex';
            ssoConfigSection.style.display = 'flex';
            if (linkRow.querySelector('input[type=url]')) {
          linkRow.querySelector('input[type=url]').setAttribute('required', 'required');
            }
        } else {
          fileRow.style.display = 'flex';
          linkRow.style.display = 'none';
            ssoConfigSection.style.display = 'none';
            ssoAdvancedPanel.style.display = 'none';
            if(ssoAdvancedToggle) ssoAdvancedToggle.checked = false;
            if (linkRow.querySelector('input[type=url]')) {
          linkRow.querySelector('input[type=url]').removeAttribute('required');
        }
          }
        };
      }
      
      if (ssoAdvancedToggle) {
        ssoAdvancedToggle.onchange = function() {
          ssoAdvancedPanel.style.display = this.checked ? 'block' : 'none';
      }
      }

      const ssoAdvancedCode = document.getElementById('ssoAdvancedCode');
      const ssoCodeValidator = document.getElementById('ssoCodeValidator');

      if (ssoAdvancedCode && ssoCodeValidator) {
          ssoAdvancedCode.addEventListener('input', function() {
              const code = this.value.trim();
              if (!code) {
                  ssoCodeValidator.textContent = '';
                  this.style.borderColor = '#ccc';
                  return;
              }

              try {
                  JSON.parse(code);
                  ssoCodeValidator.textContent = 'JSON 语法正确';
                  ssoCodeValidator.style.color = 'green';
                  this.style.borderColor = 'green';
              } catch (e) {
                  ssoCodeValidator.textContent = `语法错误: ${e.message}`;
                  ssoCodeValidator.style.color = 'red';
                  this.style.borderColor = 'red';
              }
          });
      }
    }



    // 全局变量保存快速查询显示状态
    let modelQueryShowQueryBar = false;
    function renderAndBindModelQueryTab() {
      const tabContent = document.getElementById('modelTabContent');
      tabContent.innerHTML = renderModelQueryTab(modelQueryShowQueryBar);
      // 绑定事件和初始化控件
      bindModelQueryQuickSearch();
      initCustomMultiSelect('#model-type-select');
      initDatePicker('#creation-time-picker', { mode: 'range' });
      initDatePicker('#last-modified-time-picker', { mode: 'range' });
      const creatorBtn = document.getElementById('creator-picker-btn');
      if(creatorBtn) creatorBtn.onclick = openUserSelectModal;
    }
    function bindModelTabEvents() {
      document.querySelectorAll('.model-tab').forEach(tab => {
        tab.onclick = function() {
          document.querySelectorAll('.model-tab').forEach(t => {
            t.classList.remove('active');
            t.style.color = '#185a99';
          });
          this.classList.add('active');
          this.style.color = '#2176c7';
          const tabName = this.getAttribute('data-tab');
          if (tabName === 'query') {
            modelQueryShowQueryBar = false;
            renderAndBindModelQueryTab();
          } else if (tabName === 'apply') {
            document.getElementById('modelTabContent').innerHTML = renderModelApplyTab();
          } else if (tabName === 'modify') {
            document.getElementById('modelTabContent').innerHTML = renderModelModifyTab();
          } else if (tabName === 'freeze') {
            document.getElementById('modelTabContent').innerHTML = renderModelFreezeTab();
          } else if (tabName === 'unfreeze') {
            document.getElementById('modelTabContent').innerHTML = renderModelUnfreezeTab();
          } else if (tabName === 'search') {
            document.getElementById('modelTabContent').innerHTML = renderModelSearchTab();
          } else if (tabName === 'review') {
            document.getElementById('modelTabContent').innerHTML = renderModelQueryTab();
          }
        };
      });
      renderAndBindModelQueryTab();
    }
    function bindModelQueryQuickSearch() {
      const btn = document.getElementById('modelQuickSearchBtn');
      if (!btn) return;
      btn.onclick = function() {
        modelQueryShowQueryBar = !modelQueryShowQueryBar;
        renderAndBindModelQueryTab();
      };
    }
    function renderModelQueryTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>层级展示</th>
                <th>创建人</th>
                <th>创建时间</th>
                <th>当前修改人</th>
                <th>最后修改人</th>
                <th>最后修改时间</th>
                <th>版本</th>
                <th>审核人</th>
                <th>状态</th>
                <th>语言</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='层级展示' style='width:98%;'></td>
              <td style="min-width:133px;width:133px;">
                <div style="position:relative;display:flex;align-items:center;">
                  <input type='text' id='creator-picker' placeholder='请输入或选择创建人' style='width:100%;padding-right:32px;' />
                  <span id="creator-picker-btn" style="position:absolute;right:8px;cursor:pointer;display:flex;align-items:center;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2176c7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                  </span>
                </div>
              </td>
              <td><input type='text' id='creation-time-picker' placeholder='创建时间' style='width:98%;'></td>
              <td><input type='text' placeholder='当前修改人' style='width:98%;'></td>
              <td><input type='text' placeholder='最后修改人' style='width:98%;'></td>
              <td><input type='text' id='last-modified-time-picker' placeholder='最后修改时间' style='width:98%;'></td>
              <td><input type='text' placeholder='版本' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='语言' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">元数据</a></td>
                <td>mdm_meta</td>
                <td>系统字典表</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>admin</td>
                <td>admin</td>
                <td>2022-03-25</td>
                <td>2</td>
                <td>张三</td>
                <td>正常</td>
                <td>中文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">模型类型</a></td>
                <td>mdm_model_type</td>
                <td>系统字典表</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>hefanqi</td>
                <td>admin</td>
                <td>2022-03-25</td>
                <td>4</td>
                <td>李四</td>
                <td>待提交</td>
                <td>中文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">文件类型</a></td>
                <td>mdm_sys_file_type</td>
                <td>系统字典表</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>admin</td>
                <td>admin</td>
                <td>2022-03-25</td>
                <td>2</td>
                <td>王五</td>
                <td>待提交</td>
                <td>中文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">字段类型</a></td>
                <td>mdm_field_type</td>
                <td>系统字典表</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>lichunyang</td>
                <td>admin</td>
                <td>2025-04-17</td>
                <td>2</td>
                <td>赵六</td>
                <td>正常</td>
                <td>中文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">是否</a></td>
                <td>mdm_sys_if</td>
                <td>系统字典表</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>admin</td>
                <td>admin</td>
                <td>2025-06-11</td>
                <td>3</td>
                <td>孙七</td>
                <td>正常</td>
                <td>中文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">操作类型</a></td>
                <td>mdm_op_type</td>
                <td>系统字典表</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>admin</td>
                <td>admin</td>
                <td>2025-06-11</td>
                <td>4</td>
                <td>周八</td>
                <td>正常</td>
                <td>英文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">MDM_SYSLOG</a></td>
                <td>mdm_syslog</td>
                <td>主数据</td>
                <td>否</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>admin</td>
                <td>admin</td>
                <td>2025-06-11</td>
                <td>5</td>
                <td>吴九</td>
                <td>正常</td>
                <td>中文</td>
              </tr>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">MDM_SYSTEM</a></td>
                <td>mdm_system</td>
                <td>主数据</td>
                <td>是</td>
                <td>admin</td>
                <td>2019-01-01</td>
                <td>admin</td>
                <td>admin</td>
                <td>2025-06-11</td>
                <td>6</td>
                <td>郑十</td>
                <td>待提交</td>
                <td>中文</td>
              </tr>
            </tbody>
          </table>
            </div>
          `;
    }
    // 全局变量保存各页签的快速查询显示状态
    let modelApplyShowQueryBar = false;
    let modelModifyShowQueryBar = false;
    let modelFreezeShowQueryBar = false;
    let modelUnfreezeShowQueryBar = false;
    let modelAuditShowQueryBar = false;
    let modelArchiveShowQueryBar = false;
    let modelSearchShowQueryBar = false;

    function renderModelApplyTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelApplyQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>层级展示</th>
                <th>申请理由</th>
                <th>申请人</th>
                <th>申请时间</th>
                <th>状态</th>
                <th>审核人</th>
                <th>审核时间</th>
                <th>审核意见</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='层级展示' style='width:98%;'></td>
              <td><input type='text' placeholder='申请理由' style='width:98%;'></td>
              <td><input type='text' placeholder='申请人' style='width:98%;'></td>
              <td><input type='text' placeholder='申请时间' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='审核时间' style='width:98%;'></td>
              <td><input type='text' placeholder='审核意见' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">新模型申请</a></td>
                <td>new_model_001</td>
                <td>主数据</td>
                <td>是</td>
                <td>业务需要新增模型</td>
                <td>张三</td>
                <td>2025-01-15</td>
                <td>待审核</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function renderModelModifyTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelModifyQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>修改内容</th>
                <th>修改理由</th>
                <th>修改人</th>
                <th>修改时间</th>
                <th>状态</th>
                <th>审核人</th>
                <th>审核时间</th>
                <th>审核意见</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='修改内容' style='width:98%;'></td>
              <td><input type='text' placeholder='修改理由' style='width:98%;'></td>
              <td><input type='text' placeholder='修改人' style='width:98%;'></td>
              <td><input type='text' placeholder='修改时间' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='审核时间' style='width:98%;'></td>
              <td><input type='text' placeholder='审核意见' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">元数据</a></td>
                <td>mdm_meta</td>
                <td>系统字典表</td>
                <td>字段修改</td>
                <td>业务需求变更</td>
                <td>李四</td>
                <td>2025-01-16</td>
                <td>待审核</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function renderModelFreezeTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelFreezeQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>冻结理由</th>
                <th>冻结人</th>
                <th>冻结时间</th>
                <th>状态</th>
                <th>审核人</th>
                <th>审核时间</th>
                <th>审核意见</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='冻结理由' style='width:98%;'></td>
              <td><input type='text' placeholder='冻结人' style='width:98%;'></td>
              <td><input type='text' placeholder='冻结时间' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='审核时间' style='width:98%;'></td>
              <td><input type='text' placeholder='审核意见' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">旧模型</a></td>
                <td>old_model_001</td>
                <td>字典表</td>
                <td>模型已废弃</td>
                <td>王五</td>
                <td>2025-01-17</td>
                <td>待审核</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function renderModelUnfreezeTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelUnfreezeQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>解冻理由</th>
                <th>解冻人</th>
                <th>解冻时间</th>
                <th>状态</th>
                <th>审核人</th>
                <th>审核时间</th>
                <th>审核意见</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='解冻理由' style='width:98%;'></td>
              <td><input type='text' placeholder='解冻人' style='width:98%;'></td>
              <td><input type='text' placeholder='解冻时间' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='审核时间' style='width:98%;'></td>
              <td><input type='text' placeholder='审核意见' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">临时冻结模型</a></td>
                <td>temp_frozen_model</td>
                <td>主数据</td>
                <td>业务恢复需要</td>
                <td>赵六</td>
                <td>2025-01-18</td>
                <td>待审核</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function renderModelAuditTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelAuditQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>操作类型</th>
                <th>申请人</th>
                <th>申请时间</th>
                <th>状态</th>
                <th>审核人</th>
                <th>审核时间</th>
                <th>审核意见</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择操作类型</option>
                  <option value="申请">申请</option>
                  <option value="修改">修改</option>
                  <option value="冻结">冻结</option>
                  <option value="解冻">解冻</option>
                </select>
              </td>
              <td><input type='text' placeholder='申请人' style='width:98%;'></td>
              <td><input type='text' placeholder='申请时间' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='审核时间' style='width:98%;'></td>
              <td><input type='text' placeholder='审核意见' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">新模型申请</a></td>
                <td>new_model_001</td>
                <td>主数据</td>
                <td>申请</td>
                <td>张三</td>
                <td>2025-01-15</td>
                <td>待审核</td>
                <td>审核员A</td>
                <td>-</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function renderModelArchiveTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelArchiveQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>归档理由</th>
                <th>归档人</th>
                <th>归档时间</th>
                <th>状态</th>
                <th>审核人</th>
                <th>审核时间</th>
                <th>审核意见</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='归档理由' style='width:98%;'></td>
              <td><input type='text' placeholder='归档人' style='width:98%;'></td>
              <td><input type='text' placeholder='归档时间' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='审核时间' style='width:98%;'></td>
              <td><input type='text' placeholder='审核意见' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">历史模型</a></td>
                <td>history_model_001</td>
                <td>字典表</td>
                <td>历史数据归档</td>
                <td>孙七</td>
                <td>2025-01-19</td>
                <td>待审核</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function renderModelSearchTab(showQueryBar = false) {
      return `
        <div class="action-bar">
          <button class="btn-main" id="modelSearchQuickSearchBtn"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          </span>快速查询</button>
          <button class="btn-line"><span class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6v6H9z"/></svg>
          </span>高级查询</button>
        </div>
        <div class="table-wrap">
          <table class="model-table">
            <thead>
              <tr>
                <th class="checkbox-cell"><input type="checkbox"></th>
                <th>模型名称</th>
                <th>模型编码</th>
                <th>类型</th>
                <th>层级展示</th>
                <th>创建人</th>
                <th>创建时间</th>
                <th>当前修改人</th>
                <th>最后修改人</th>
                <th>最后修改时间</th>
                <th>版本</th>
                <th>审核人</th>
                <th>状态</th>
                <th>语言</th>
              </tr>
            </thead>
            ${showQueryBar ? `<tr class='query-bar-row' style='background:#f4f8fc;'>
              <td class='checkbox-cell'></td>
              <td><input type='text' placeholder='模型名称' style='width:98%;'></td>
              <td><input type='text' placeholder='模型编码' style='width:98%;'></td>
              <td>
                <select class="form-select" style="width:98%;">
                  <option value="">请选择类型</option>
                  <option value="系统字典表">系统字典表</option>
                  <option value="字典表">字典表</option>
                  <option value="主数据">主数据</option>
                </select>
              </td>
              <td><input type='text' placeholder='层级展示' style='width:98%;'></td>
              <td><input type='text' placeholder='创建人' style='width:98%;'></td>
              <td><input type='text' placeholder='创建时间' style='width:98%;'></td>
              <td><input type='text' placeholder='当前修改人' style='width:98%;'></td>
              <td><input type='text' placeholder='最后修改人' style='width:98%;'></td>
              <td><input type='text' placeholder='最后修改时间' style='width:98%;'></td>
              <td><input type='text' placeholder='版本' style='width:98%;'></td>
              <td><input type='text' placeholder='审核人' style='width:98%;'></td>
              <td><input type='text' placeholder='状态' style='width:98%;'></td>
              <td><input type='text' placeholder='语言' style='width:98%;'></td>
            </tr>` : ''}
            <tbody>
              <tr>
                <td class="checkbox-cell"><input type="checkbox"></td>
                <td><a href="#">检索模型</a></td>
                <td>search_model_001</td>
                <td>主数据</td>
                <td>是</td>
                <td>周八</td>
                <td>2025-01-20</td>
                <td>周八</td>
                <td>周八</td>
                <td>2025-01-20</td>
                <td>1</td>
                <td>审核员B</td>
                <td>正常</td>
                <td>中文</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    // 主题设置下拉菜单逻辑
    const settingBtn = document.getElementById('settingBtn');
    const themeDropdown = document.getElementById('themeDropdown');
    let themeDropdownOpen = false;
    settingBtn.onclick = function(e) {
      themeDropdownOpen = !themeDropdownOpen;
      themeDropdown.style.display = themeDropdownOpen ? 'block' : 'none';
      themeDropdown.classList.toggle('show', themeDropdownOpen);
      e.stopPropagation();
      // 高亮当前主题
      const theme = localStorage.getItem('theme') || 'blue';
      document.querySelectorAll('.theme-dropdown-item').forEach(item => {
        item.classList.toggle('selected', item.dataset.theme === theme);
      });
    };
    document.querySelectorAll('.theme-dropdown-item').forEach(item => {
      item.onclick = function(e) {
        document.querySelectorAll('.theme-dropdown-item').forEach(i => i.classList.remove('selected'));
        this.classList.add('selected');
        setTheme(this.dataset.theme);
        themeDropdown.style.display = 'none';
        themeDropdown.classList.remove('show');
        themeDropdownOpen = false;
        e.stopPropagation();
      };
    });
    document.addEventListener('click', function(e) {
      if (themeDropdownOpen && !themeDropdown.contains(e.target) && e.target !== settingBtn) {
        themeDropdown.style.display = 'none';
        themeDropdown.classList.remove('show');
        themeDropdownOpen = false;
      }
      if (userDropdownOpen && !userDropdown.contains(e.target) && e.target !== userInfo) {
        userDropdown.classList.remove('show');
        userDropdownOpen = false;
      }
    });
    function setTheme(theme) {
      if (theme === 'blue') {
        document.documentElement.style.setProperty('--theme-bg', '#f4f8fb');
        document.documentElement.style.setProperty('--theme-topbar', 'linear-gradient(90deg, #2176c7 60%, #3ba1e3 100%)');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#f4f8fb');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#2176c7');
        document.documentElement.style.setProperty('--theme-menu-hover', '#185a99');
        document.documentElement.style.setProperty('--theme-table-header', '#f4f8fb');
        document.documentElement.style.setProperty('--theme-table-header-font', '#2176c7');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#f0f6fd');
        document.documentElement.style.setProperty('--theme-table-border', '#e3eaf3');
        document.documentElement.style.setProperty('--theme-btn', '#2176c7');
        document.documentElement.style.setProperty('--theme-btn-hover', '#185a99');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#eaf3fb');
        document.documentElement.style.setProperty('--theme-avatar-font', '#2176c7');
        document.documentElement.style.setProperty('--theme-content-text', '#185a99');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(33, 118, 199, 0.06)');
      } else if (theme === 'white') {
        document.documentElement.style.setProperty('--theme-bg', '#fff');
        document.documentElement.style.setProperty('--theme-topbar', '#fff');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#fff');
        document.documentElement.style.setProperty('--theme-topbar-font', '#2176c7');
        document.documentElement.style.setProperty('--theme-menu-active', '#2176c7');
        document.documentElement.style.setProperty('--theme-menu-hover', '#185a99');
        document.documentElement.style.setProperty('--theme-table-header', '#f4f8fb');
        document.documentElement.style.setProperty('--theme-table-header-font', '#2176c7');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#f0f6fd');
        document.documentElement.style.setProperty('--theme-table-border', '#e3eaf3');
        document.documentElement.style.setProperty('--theme-btn', '#2176c7');
        document.documentElement.style.setProperty('--theme-btn-hover', '#185a99');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#eaf3fb');
        document.documentElement.style.setProperty('--theme-avatar-font', '#2176c7');
        document.documentElement.style.setProperty('--theme-content-text', '#185a99');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(33, 118, 199, 0.06)');
      } else if (theme === 'dark') {
        document.documentElement.style.setProperty('--theme-bg', '#181c24');
        document.documentElement.style.setProperty('--theme-topbar', '#222');
        document.documentElement.style.setProperty('--theme-sidebar', '#23272f');
        document.documentElement.style.setProperty('--theme-content', '#181c24');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#ffe082');
        document.documentElement.style.setProperty('--theme-menu-hover', '#fff');
        document.documentElement.style.setProperty('--theme-table-header', '#23272f');
        document.documentElement.style.setProperty('--theme-table-header-font', '#ffe082');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#23272f');
        document.documentElement.style.setProperty('--theme-table-border', '#333');
        document.documentElement.style.setProperty('--theme-btn', '#ffe082');
        document.documentElement.style.setProperty('--theme-btn-hover', '#fff');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#23272f');
        document.documentElement.style.setProperty('--theme-avatar-font', '#ffe082');
        document.documentElement.style.setProperty('--theme-content-text', '#e0e0e0');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(0, 0, 0, 0.3)');
      } else if (theme === 'green') {
        document.documentElement.style.setProperty('--theme-bg', '#eafaf1');
        document.documentElement.style.setProperty('--theme-topbar', 'linear-gradient(90deg, #2ecc71 60%, #27ae60 100%)');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#eafaf1');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#27ae60');
        document.documentElement.style.setProperty('--theme-menu-hover', '#145a32');
        document.documentElement.style.setProperty('--theme-table-header', '#eafaf1');
        document.documentElement.style.setProperty('--theme-table-header-font', '#27ae60');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#d4efdf');
        document.documentElement.style.setProperty('--theme-table-border', '#b7e1cd');
        document.documentElement.style.setProperty('--theme-btn', '#27ae60');
        document.documentElement.style.setProperty('--theme-btn-hover', '#145a32');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#d4efdf');
        document.documentElement.style.setProperty('--theme-avatar-font', '#27ae60');
        document.documentElement.style.setProperty('--theme-content-text', '#185a99');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(0, 128, 0, 0.1)');
      } else if (theme === 'purple') {
        document.documentElement.style.setProperty('--theme-bg', '#f6f0fa');
        document.documentElement.style.setProperty('--theme-topbar', 'linear-gradient(90deg, #8e44ad 60%, #6c3483 100%)');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#f6f0fa');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#8e44ad');
        document.documentElement.style.setProperty('--theme-menu-hover', '#512e5f');
        document.documentElement.style.setProperty('--theme-table-header', '#f6f0fa');
        document.documentElement.style.setProperty('--theme-table-header-font', '#8e44ad');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#e8daef');
        document.documentElement.style.setProperty('--theme-table-border', '#d2b4de');
        document.documentElement.style.setProperty('--theme-btn', '#8e44ad');
        document.documentElement.style.setProperty('--theme-btn-hover', '#512e5f');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#e8daef');
        document.documentElement.style.setProperty('--theme-avatar-font', '#8e44ad');
        document.documentElement.style.setProperty('--theme-content-text', '#512e5f');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(128, 0, 128, 0.1)');
      } else if (theme === 'orange') {
        document.documentElement.style.setProperty('--theme-bg', '#fff7ed');
        document.documentElement.style.setProperty('--theme-topbar', 'linear-gradient(90deg, #ff9800 60%, #f57c00 100%)');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#fff7ed');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#ff9800');
        document.documentElement.style.setProperty('--theme-menu-hover', '#e65100');
        document.documentElement.style.setProperty('--theme-table-header', '#fff7ed');
        document.documentElement.style.setProperty('--theme-table-header-font', '#ff9800');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#ffe0b2');
        document.documentElement.style.setProperty('--theme-table-border', '#ffcc80');
        document.documentElement.style.setProperty('--theme-btn', '#ff9800');
        document.documentElement.style.setProperty('--theme-btn-hover', '#e65100');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#ffe0b2');
        document.documentElement.style.setProperty('--theme-avatar-font', '#ff9800');
        document.documentElement.style.setProperty('--theme-content-text', '#e65100');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(255, 165, 0, 0.1)');
      } else if (theme === 'red') {
        document.documentElement.style.setProperty('--theme-bg', '#fff0f0');
        document.documentElement.style.setProperty('--theme-topbar', 'linear-gradient(90deg, #e74c3c 60%, #c0392b 100%)');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#fff0f0');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#e74c3c');
        document.documentElement.style.setProperty('--theme-menu-hover', '#922b21');
        document.documentElement.style.setProperty('--theme-table-header', '#fff0f0');
        document.documentElement.style.setProperty('--theme-table-header-font', '#e74c3c');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#fadbd8');
        document.documentElement.style.setProperty('--theme-table-border', '#f5b7b1');
        document.documentElement.style.setProperty('--theme-btn', '#e74c3c');
        document.documentElement.style.setProperty('--theme-btn-hover', '#922b21');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#fadbd8');
        document.documentElement.style.setProperty('--theme-avatar-font', '#e74c3c');
        document.documentElement.style.setProperty('--theme-content-text', '#922b21');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(255, 0, 0, 0.1)');
      } else if (theme === 'gray') {
        document.documentElement.style.setProperty('--theme-bg', '#f7f7f7');
        document.documentElement.style.setProperty('--theme-topbar', '#7f8c8d');
        document.documentElement.style.setProperty('--theme-sidebar', '#fff');
        document.documentElement.style.setProperty('--theme-content', '#f7f7f7');
        document.documentElement.style.setProperty('--theme-topbar-font', '#fff');
        document.documentElement.style.setProperty('--theme-menu-active', '#7f8c8d');
        document.documentElement.style.setProperty('--theme-menu-hover', '#222');
        document.documentElement.style.setProperty('--theme-table-header', '#f7f7f7');
        document.documentElement.style.setProperty('--theme-table-header-font', '#7f8c8d');
        document.documentElement.style.setProperty('--theme-table-row-hover', '#e0e0e0');
        document.documentElement.style.setProperty('--theme-table-border', '#bfc9ca');
        document.documentElement.style.setProperty('--theme-btn', '#7f8c8d');
        document.documentElement.style.setProperty('--theme-btn-hover', '#222');
        document.documentElement.style.setProperty('--theme-avatar-bg', '#e0e0e0');
        document.documentElement.style.setProperty('--theme-avatar-font', '#7f8c8d');
        document.documentElement.style.setProperty('--theme-content-text', '#222');
        document.documentElement.style.setProperty('--theme-shadow-color', 'rgba(0, 0, 0, 0.08)');
      }
      localStorage.setItem('theme', theme);
    }
    // 记忆主题
    setTheme('blue');
    // AI对话抽屉逻辑
    document.getElementById('aiBtn').onclick = function() {
      document.getElementById('drawerMask').style.display = 'block';
    };
    function closeDrawer() {
      document.getElementById('drawerMask').style.display = 'none';
    }
    document.getElementById('drawerMask').onclick = function(e) {
      if (e.target === this) closeDrawer();
    };
    // AI助手对话框逻辑
    function openAIDrawer() {
      document.getElementById('aiDrawer').style.width = '400px';
      document.getElementById('drawerOverlay').style.display = 'block';
    }

    function closeAIDrawer() {
      document.getElementById('aiDrawer').style.width = '0';
      document.getElementById('drawerOverlay').style.display = 'none';
    }

    function sendAIMessage() {
      const aiInput = document.getElementById('aiInput');
      const messageText = aiInput.value.trim();
      if (messageText === '') return;

      const chatMessages = document.getElementById('chatHistory');

      // 用户消息
      const userMessageDiv = document.createElement('div');
      userMessageDiv.style.cssText = `
        display: flex;
        justify-content: flex-end;
      `;
      userMessageDiv.innerHTML = `
        <div style="background: #2176c7; color: white; padding: 12px 18px; border-radius: 18px 18px 4px 18px; max-width: 80%;">
          ${messageText}
        </div>
      `;
      chatMessages.appendChild(userMessageDiv);

      // 模拟AI回复
      setTimeout(() => {
        const aiMessageDiv = document.createElement('div');
        aiMessageDiv.style.cssText = `
          display: flex;
          justify-content: flex-start;
        `;
        aiMessageDiv.innerHTML = `
          <div style="background: #eaf3fb; color: #333; padding: 12px 18px; border-radius: 18px 18px 18px 4px; max-width: 80%;">
            你好，我已收到你的消息："${messageText}"。我正在思考...
          </div>
        `;
        chatMessages.appendChild(aiMessageDiv);
        // 滚动到底部
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }, 1000);

      aiInput.value = '';
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // 用户信息下拉菜单
    const userInfo = document.getElementById('userInfo');
    const userDropdown = document.getElementById('userDropdown');
    let userDropdownOpen = false;
    userInfo.onclick = function(e) {
      userDropdownOpen = !userDropdownOpen;
      userDropdown.classList.toggle('show', userDropdownOpen);
      e.stopPropagation();
    };

    // 快捷入口数据持久化与渲染
    function getQuickEntryList() {
      try {
        const stored = localStorage.getItem('quickEntryList');
        // V2版本：如果本地没有，则使用默认值
        if (!stored) {
          const defaultEntries = getAllMenuEntries().slice(0, 4); // 默认前4个
          setQuickEntryList(defaultEntries);
          return defaultEntries;
        }
        return JSON.parse(stored);
      } catch {
        return [];
      }
    }
    function setQuickEntryList(list) {
      localStorage.setItem('quickEntryList', JSON.stringify(list));
    }
    function renderQuickEntryBar(isEditing = false) {
      const list = getQuickEntryList();
      const bar = document.getElementById('quickEntryBar');
      if (!bar) return;
      bar.innerHTML = '';
      list.forEach((entry, idx) => {
        const item = document.createElement('div');
        item.className = 'quick-entry-item';
        if (isEditing) item.classList.add('editing');
        item.draggable = isEditing;
        item.innerHTML = `<div class="icon">${entry.icon}</div><div class="label">${entry.label}</div><button class="remove-btn" onclick="removeQuickEntry(${idx})">&times;</button>`;
        if (isEditing) {
          item.ondragstart = (e) => onQuickEntryDragStart(e, idx);
          item.ondragover = (e) => onQuickEntryDragOver(e, idx);
          item.ondrop = (e) => onQuickEntryDrop(e, idx);
          item.ondragend = onQuickEntryDragEnd;
        } else {
          item.onclick = () => {
             const menuItem = document.querySelector(`.submenu-item[data-item-id='${entry.type}']`) || document.querySelector(`.submenu-item[data-content='${entry.type}']`);
             if (menuItem) menuItem.click();
          };
        }
        bar.appendChild(item);
      });
      // 拖拽容器事件
      bar.ondragover = (e) => onQuickEntryDragOver(e, null);
      bar.ondrop = (e) => onQuickEntryDrop(e, list.length);
    }
    function removeQuickEntry(idx) {
      let list = getQuickEntryList();
      list.splice(idx, 1);
      setQuickEntryList(list);
      renderQuickEntryBar(true); // 保持编辑模式
    }
    function openQuickEntryModal() {
      const list = getQuickEntryList();
      const allEntries = getAllMenuEntries();
      const addedTypes = list.map(e => e.type);
      const canAdd = allEntries.filter(e => !addedTypes.includes(e.type));
      if (canAdd.length === 0) { alert('没有可添加的快捷入口'); return; }
      let html = '<div id="quickEntryModalMask" style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.18);z-index:3000;display:flex;align-items:center;justify-content:center;">';
      html += '<div style="background:#fff;border-radius:12px;min-width:320px;max-width:90vw;padding:28px 32px;box-shadow:0 4px 24px rgba(33,118,199,0.13);">';
      html += '<div style="font-size:18px;font-weight:600;color:#2176c7;margin-bottom:18px;">选择要添加的快捷入口</div>';
      html += '<div style="display:flex;flex-wrap:wrap;gap:18px 18px;">';
      canAdd.forEach(e => {
        html += `<div class="quick-entry-item" style="width:80px;height:90px;" onclick="addQuickEntry('${e.type}')">
          <div class="icon">${e.icon}</div>
          <div class="label">${e.label}</div>
        </div>`;
      });
      html += '</div>';
      html += '<div style="text-align:right;margin-top:18px;"><button onclick="closeQuickEntryModal()" style="background:#eaf3fb;color:#2176c7;padding:6px 24px;border:none;border-radius:6px;font-size:15px;">取消</button></div>';
      html += '</div></div>';
      document.body.insertAdjacentHTML('beforeend', html);
    }
    function closeQuickEntryModal() {
      const mask = document.getElementById('quickEntryModalMask');
      if (mask) mask.remove();
    }
    function addQuickEntry(type) {
      // 清空localStorage缓存，确保新label生效
      localStorage.removeItem('quickEntryList');
      const entry = getAllMenuEntries().find(e => e.type === type);
      if (!entry) return;
      let list = getQuickEntryList();
      list.push(entry);
      setQuickEntryList(list);
      closeQuickEntryModal();
      renderQuickEntryBar();
    }
    let quickEntryEditMode = false;
    function toggleQuickEntryEdit() {
      quickEntryEditMode = !quickEntryEditMode;
      renderQuickEntryBar(quickEntryEditMode);
    }
    // 拖拽排序逻辑
    let dragIdx = null;
    function onQuickEntryDragStart(e, idx) {
      dragIdx = idx;
      e.currentTarget.classList.add('dragging');
    }
    function onQuickEntryDragOver(e, idx) {
      e.preventDefault();
      const items = document.querySelectorAll('.quick-entry-item');
      items.forEach(i => i.classList.remove('drag-over'));
      if (typeof idx === 'number') items[idx].classList.add('drag-over');
    }
    function onQuickEntryDrop(e, idx) {
      e.preventDefault();
      let list = getQuickEntryList();
      if (dragIdx !== null && dragIdx !== idx) {
        const moved = list.splice(dragIdx, 1)[0];
        list.splice(idx, 0, moved);
        setQuickEntryList(list);
        renderQuickEntryBar(quickEntryEditMode);
      }
      dragIdx = null;
      document.querySelectorAll('.quick-entry-item').forEach(i => i.classList.remove('drag-over','dragging'));
    }
    function onQuickEntryDragEnd(e) {
      dragIdx = null;
      document.querySelectorAll('.quick-entry-item').forEach(i => i.classList.remove('drag-over','dragging'));
    }
    document.addEventListener('DOMContentLoaded', () => {
      renderQuickEntryBar();
    });

    // 获取所有可添加的快捷入口（自动从菜单提取）
    function getAllMenuEntries() {
      const icons = {
        'data-model-apply': `<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="url(#g1)"/><path d="M32 16H16v16l8-6 8 6V16z" fill="#fff"/><path d="M20 24l4 4 4-4" stroke="#4caf50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><defs><linearGradient id="g1" x1="8" y1="8" x2="40" y2="40" gradientUnits="userSpaceOnUse"><stop stop-color="#6ee7b7"/><stop offset="1" stop-color="#34d399"/></linearGradient></defs>`,
        'notice': `<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="url(#g2)"/><path d="M32 16H16v16l8-6 8 6V16z" fill="#fff"/><path d="M20 24l4 4 4-4" stroke="#a78bfa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><defs><linearGradient id="g2" x1="8" y1="8" x2="40" y2="40" gradientUnits="userSpaceOnUse"><stop stop-color="#c4b5fd"/><stop offset="1" stop-color="#a78bfa"/></linearGradient></defs>`,
        'log': `<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="url(#g3)"/><path d="M32 16H16v16l8-6 8 6V16z" fill="#fff"/><path d="M20 24l4 4 4-4" stroke="#fbbf24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><defs><linearGradient id="g3" x1="8" y1="8" x2="40" y2="40" gradientUnits="userSpaceOnUse"><stop stop-color="#fde68a"/><stop offset="1" stop-color="#fbbf24"/></linearGradient></defs>`,
        'data-perm': `<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="url(#g4)"/><path d="M32 16H16v16l8-6 8 6V16z" fill="#fff"/><path d="M20 24l4 4 4-4" stroke="#60a5fa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg><defs><linearGradient id="g4" x1="8" y1="8" x2="40" y2="40" gradientUnits="userSpaceOnUse"><stop stop-color="#93c5fd"/><stop offset="1" stop-color="#60a5fa"/></linearGradient></defs>`,
        'data-model-apply': '<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="#e3f2fd"/><path d="M24 16v16M16 24h16" stroke="#2196f3" stroke-width="3" stroke-linecap="round"/></svg>',
        'notice': '<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="12" width="32" height="24" rx="8" fill="#fff3e0"/><rect x="16" y="20" width="16" height="8" rx="4" fill="#fb8c00"/></svg>',
        'log': '<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="12" width="32" height="24" rx="8" fill="#ede7f6"/><rect x="16" y="20" width="16" height="8" rx="4" fill="#7e57c2"/></svg>',
        'data-perm': '<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="#e8f5e9"/><path d="M24 16v16M16 24h16" stroke="#43a047" stroke-width="3" stroke-linecap="round"/></svg>',
        'sys-dict': '<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="#f3e5f5"/><rect x="16" y="20" width="16" height="8" rx="4" fill="#8e24aa"/></svg>',
        // 其它类型可继续补充
      };
      const result = [];
      document.querySelectorAll('.submenu-item').forEach(item => {
        const type = item.getAttribute('data-item-id') || item.getAttribute('data-content') || item.textContent.trim();
        let label = item.getAttribute('data-label');
        if (!label) {
          label = '';
          for (const node of item.childNodes) {
            if (node.nodeType === 3) {
              label += node.textContent;
            } else if (node.nodeType === 1 && node.classList && !node.classList.contains('favorite-btn')) {
              label += node.textContent;
            }
          }
          label = label.replace(/\s+/g, '').trim();
        }
        let icon = icons[type] || '<svg width="48" height="48" viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="12" fill="#f5f5f5"/><path d="M16 24h16" stroke="#bdbdbd" stroke-width="3"/></svg>';
        result.push({ type, label, icon });
      });
      return result;
    }

    function showCockpitPage() {
      document.getElementById('mainContent').innerHTML = `<iframe src='cockpit.html' style='width:100%;height:calc(100vh - 110px);border:none;border-radius:12px;box-shadow:0 2px 8px rgba(33,118,199,0.10);background:#0a1a2a;'></iframe>`;
    }

    // 1. 拦截友情链接表单提交，保存到localStorage
    function handleNoticeAddFormSubmit(e) {
      e.preventDefault();
      const form = e.target;
      const category = form.querySelector('#noticeFileCategory').value;
      if (category === '友情链接') {
        const title = form.querySelector('input[type="text"]').value.trim();
        const link = form.querySelector('input[type="url"]').value.trim();
        const iconInput = form.querySelector('#noticeLinkRow input[type="file"]');
        if (!title || !link) {
          alert('请填写完整标题和链接地址');
          return;
        }
        // 读取图标文件为Base64
        const file = iconInput.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(evt) {
            saveFriendLink({ title, link, icon: evt.target.result });
            closeNoticeAddModal();
          };
          reader.readAsDataURL(file);
        } else {
          saveFriendLink({ title, link, icon: '' });
          closeNoticeAddModal();
        }
      } else {
        // 其它分类原有逻辑...
        closeNoticeAddModal();
      }
    }
    function saveFriendLink(item) {
      let list = [];
      try { list = JSON.parse(localStorage.getItem('friendLinks')) || []; } catch { list = []; }
      list.push(item);
      localStorage.setItem('friendLinks', JSON.stringify(list));
      renderFriendLinks();
    }
    function closeNoticeAddModal() {
      document.getElementById('noticeAddModal').style.display = 'none';
    }
    // 2. 首页动态渲染友情链接
    function renderFriendLinks() {
      const list = JSON.parse(localStorage.getItem('friendLinks') || '[]');
      const container = document.getElementById('friendLinksList');
      if (!container) return;
      if (list.length === 0) {
        container.innerHTML = '<li style="color:#bbb;">暂无友情链接</li>';
        return;
      }
      container.innerHTML = list.map(item =>
        `<li style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
          ${item.icon ? `<img src="${item.icon}" alt="icon" style="width:28px;height:28px;border-radius:6px;object-fit:cover;box-shadow:0 1px 4px #e3eaf3;">` : '<span style="width:28px;height:28px;display:inline-block;background:#eaf3fb;border-radius:6px;"></span>'}
          <a href="${item.link}" target="_blank" style="font-weight:500;color:#2176c7;text-decoration:none;">${item.title}</a>
        </li>`
      ).join('');
    }
    // 3. 首页区域插入渲染容器
    (function patchHomeFriendLinks() {
      const home = document.getElementById('homePage');
      if (!home) return;
      const rightCols = home.querySelectorAll('div[style*="flex:1;"]');
      if (rightCols.length > 0) {
        const lastCol = rightCols[rightCols.length-1];
        const linkCard = lastCol.querySelector('div:has(svg+span:contains("网站链接"))');
        if (linkCard) {
          const ul = linkCard.querySelector('ul');
          if (ul) {
            ul.id = 'friendLinksList';
            renderFriendLinks();
          }
        }
      }
    })();
    // 4. 绑定表单事件（每次弹窗渲染后都需绑定）
    function bindNoticeAddFormSubmit() {
      const form = document.getElementById('noticeAddForm');
      if (form) {
        form.onsubmit = handleNoticeAddFormSubmit;
      }
    }
    // 在showNoticeTable渲染后绑定
    const oldShowNoticeTable = showNoticeTable;
    showNoticeTable = function() {
      oldShowNoticeTable();
      setTimeout(bindNoticeAddFormSubmit, 0);
    };
    // 页面初始渲染时也绑定一次
    if (document.getElementById('noticeAddForm')) {
      bindNoticeAddFormSubmit();
    }

    function showConditionPage() {
      document.getElementById('mainContent').innerHTML = `<iframe src='condition.html' style='width:100%;height:calc(100vh - 110px);border:none;border-radius:12px;box-shadow:0 2px 8px rgba(33,118,199,0.10);'></iframe>`;
    }

    function showDataCollectionConfigPage() {
      document.getElementById('mainContent').innerHTML = `
        <iframe src="data_receive.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>
      `;
    }

    function showPushLogPage() {
      const mainContent = document.getElementById('mainContent');
      // ... existing code ...
    }

    function showDataPushConfigPage() {
      document.getElementById('mainContent').innerHTML = `
        <iframe src="data_send.html" style="width:100%; height:calc(100vh - 120px); border:none;"></iframe>
      `;
    }



    // 系统字典页面
    function showSystemDictPage() {
      document.getElementById('mainContent').innerHTML = `
        <iframe src="data_dict.html" style="width:100%; height:calc(100vh - 110px); border:none; border-radius:12px; box-shadow:0 2px 8px rgba(33,118,199,0.10);"></iframe>
      `;
    }

    // 搜索弹窗逻辑
    const searchBtn = document.getElementById('searchBtn');
    const searchModalMask = document.getElementById('searchModalMask');
    const searchInput = document.getElementById('searchInput');
    const searchCloseBtn = document.getElementById('searchCloseBtn');
    const searchSubmitBtn = document.getElementById('searchSubmitBtn');
    // 打开弹窗
    searchBtn.onclick = function() {
      searchModalMask.style.display = 'flex';
      setTimeout(()=>{ searchInput && searchInput.focus(); }, 100);
    };
    // 关闭弹窗
    function closeSearchModal() {
      searchModalMask.style.display = 'none';
      if(searchInput) searchInput.value = '';
    }


    searchCloseBtn.onclick = closeSearchModal;
    searchModalMask.onclick = function(e) {
      if(e.target === this) closeSearchModal();
    };
    document.addEventListener('keydown', function(e) {
      if(searchModalMask.style.display==='flex' && e.key==='Escape') closeSearchModal();
      if(searchModalMask.style.display==='flex' && e.key==='Enter' && document.activeElement===searchInput) {
        // 这里可处理搜索逻辑
        closeSearchModal();
      }
    });
    searchSubmitBtn.onclick = function() {
      // 这里可处理搜索逻辑
      console.log('Searching for:', searchInput.value);
      closeSearchModal();
    };




    // JS联动逻辑
    // 权限范围弹窗相关
    document.getElementById('noticePermInput').onclick = openPermModal;
    document.getElementById('noticePermBtn').onclick = openPermModal;
    function openPermModal() {
      document.getElementById('permSelectModal').style.display = 'flex';
    }
    document.getElementById('permSelectClose').onclick = function() {
      document.getElementById('permSelectModal').style.display = 'none';
    };
    document.getElementById('permSelectCancel').onclick = function() {
      document.getElementById('permSelectModal').style.display = 'none';
    };
    document.querySelectorAll('.perm-tab').forEach(tab => {
      tab.onclick = function() {
        document.querySelectorAll('.perm-tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        const tabName = this.getAttribute('data-tab');
        document.querySelectorAll('.perm-list').forEach(list => {
          list.style.display = list.getAttribute('data-tab') === tabName ? '' : 'none';
        });
      };
    });
    document.getElementById('permSelectOk').onclick = function() {
      let selected = [];
      document.querySelectorAll('.perm-list').forEach(list => {
        list.querySelectorAll('input[type=checkbox]:checked').forEach(cb => {
          selected.push(cb.value);
        });
      });
      document.getElementById('noticePermInput').value = selected.join(', ');
      document.getElementById('permSelectModal').style.display = 'none';
    };

    function initCustomMultiSelect(containerSelector) {
        // 已移除多选功能，改为标准下拉框
    }

    function initDatePicker(selector) {
        const el = document.querySelector(selector);
        if (el) {
            flatpickr(el, {
                locale: "zh",
                dateFormat: "Y-m-d",
            });
        }
    }

    function renderModelTabPage() {
      document.getElementById('mainContent').innerHTML = `
        <div class="model-tabs-bar" style="display:flex;gap:2px;border-bottom:1.5px solid #e3eaf3;margin-bottom:18px;">
          <div class="model-tab active" data-tab="query" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#2176c7;">模型查询</div>
          <div class="model-tab" data-tab="apply" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#185a99;">模型申请</div>
          <div class="model-tab" data-tab="modify" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#185a99;">模型修改</div>
          <div class="model-tab" data-tab="freeze" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#185a99;">模型冻结</div>
          <div class="model-tab" data-tab="unfreeze" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#185a99;">模型解冻</div>
          <div class="model-tab" data-tab="review" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#185a99;">模型审核</div>
          <div class="model-tab" data-tab="search" style="padding:12px 28px;cursor:pointer;font-size:16px;font-weight:500;color:#185a99;">模型检索</div>
        </div>
        <div class="model-tab-content" id="modelTabContent"></div>
      `;
    }



    

  </script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://npmcdn.com/flatpickr/dist/l10n/zh.js"></script>

</body>
</html> 