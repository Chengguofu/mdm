<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>主数据服务订阅</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #f4f7fa;
            padding: 2rem;
            font-size: 15px;
        }
        .nav-tabs .nav-link {
            border-top-left-radius: .5rem;
            border-top-right-radius: .5rem;
            font-weight: 500;
            font-size: 15px;
        }
        .tab-content {
            border: 1px solid #dee2e6;
            border-top: 0;
            padding: 1.5rem;
            background-color: #fff;
            border-bottom-left-radius: .5rem;
            border-bottom-right-radius: .5rem;
            font-size: 14px;
        }
        .config-table-in-tab td {
            padding: 0.8rem 1rem;
            vertical-align: middle;
            font-size: 14px;
        }
        .config-table-in-tab td:first-child {
            width: 25%;
            font-weight: 500;
            background-color: #f8f9fa;
            font-size: 14px;
        }
        .form-control, .form-select {
            font-size: 14px;
        }
        h3, .h3 {
            font-size: 23px;
        }
        .btn, .btn-sm, .btn-primary, .btn-success {
            font-size: 13px;
        }
    </style>
</head>
<body>

<div class="container-fluid">
    <h3 class="mb-4">主数据查询服务配置</h3>

    <!-- Tab navigation -->
    <ul class="nav nav-tabs" id="configTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="basic-config-tab" data-bs-toggle="tab" data-bs-target="#basic-config" type="button" role="tab" aria-controls="basic-config" aria-selected="true">基本配置</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="api-auth-tab" data-bs-toggle="tab" data-bs-target="#api-auth" type="button" role="tab" aria-controls="api-auth" aria-selected="false">接口授权</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="query-condition-config-tab" data-bs-toggle="tab" data-bs-target="#query-condition-config" type="button" role="tab" aria-controls="query-condition-config" aria-selected="false">查询条件配置</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="field-config-tab" data-bs-toggle="tab" data-bs-target="#field-config" type="button" role="tab" aria-controls="field-config" aria-selected="false">查询结果配置</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="data-scope-tab" data-bs-toggle="tab" data-bs-target="#data-scope" type="button" role="tab" aria-controls="data-scope" aria-selected="false">数据范围配置</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="format-preview-tab" data-bs-toggle="tab" data-bs-target="#format-preview" type="button" role="tab" aria-controls="format-preview" aria-selected="false">服务接口预览</button>
        </li>
    </ul>

    <!-- Tab content -->
    <div class="tab-content" id="configTabContent">
        <!-- 基本配置 Tab -->
        <div class="tab-pane fade show active" id="basic-config" role="tabpanel" aria-labelledby="basic-config-tab">
            <table class="table table-bordered m-0 config-table-in-tab">
                <tbody>
                    <tr>
                        <td>主数据模型</td>
                        <td><select class="form-select"><option>客户主数据</option><option>供应商主数据</option><option>产品主数据</option><option>员工主数据</option><option>组织主数据</option></select></td>
                        <td>业务系统</td>
                        <td><select class="form-select"><option>OA系统</option><option>ERP系统</option><option>CRM系统</option></select></td>
                    </tr>
                    <tr>
                        <td>接口服务编码</td>
                        <td><input type="text" class="form-control" value="API_00123"></td>
                        <td>接口服务名称</td>
                        <td><input type="text" class="form-control" value="客户主数据接收接口"></td>
                    </tr>
                    <tr>
                        <td>接口类型</td>
                        <td colspan="3">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="apiType" id="json" checked>
                                <label class="form-check-label" for="json">JSON</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="apiType" id="xml">
                                <label class="form-check-label" for="xml">XML</label>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 接口授权 Tab -->
        <div class="tab-pane fade" id="api-auth" role="tabpanel" aria-labelledby="api-auth-tab">
            <table class="table table-bordered m-0 config-table-in-tab">
                <tbody>
                    <tr>
                        <td>API用户</td>
                        <td><input type="text" class="form-control" value="api_user"></td>
                    </tr>
                    <tr>
                        <td>API密钥</td>
                        <td><input type="password" class="form-control" value="************"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 查询条件配置 Tab -->
        <div class="tab-pane fade" id="query-condition-config" role="tabpanel" aria-labelledby="query-condition-config-tab">
             <table class="table table-bordered m-0 config-table-in-tab">
                <tbody>
                    <tr>
                        <td>模型所有属性</td>
                        <td>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" value="" id="childTableSelectableQuery" checked>
                                <label class="form-check-label" for="childTableSelectableQuery">
                                    包含子表
                                </label>
                            </div>
                        </td>
                    </tr>
                     <tr>
                        <td colspan="2" class="p-0">
                            <table class="table table-hover table-sm mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>字段名</th>
                                        <th>中文名</th>
                                        <th>类型</th>
                                        <th>是否选择</th>
                                        <th>字段映射名称</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>CUST_ID</td>
                                        <td>客户编码</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" checked onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="customerId"></td>
                                    </tr>
                                    <tr>
                                        <td>CUST_NAME</td>
                                        <td>客户名称</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" checked onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="customerName"></td>
                                    </tr>
                                    <tr>
                                        <td>ADDRESS</td>
                                        <td>地址</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" checked onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="address"></td>
                                    </tr>
                                    <tr>
                                        <td>CONTACT</td>
                                        <td>联系人</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="contact"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 查询结果配置 Tab -->
        <div class="tab-pane fade" id="field-config" role="tabpanel" aria-labelledby="field-config-tab">
             <table class="table table-bordered m-0 config-table-in-tab">
                <tbody>
                    <tr>
                        <td>模型所有属性</td>
                        <td>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" value="" id="childTableSelectable" checked>
                                <label class="form-check-label" for="childTableSelectable">
                                    包含子表
                                </label>
                            </div>
                        </td>
                    </tr>
                     <tr>
                        <td colspan="2" class="p-0">
                            <table class="table table-hover table-sm mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>字段名</th>
                                        <th>中文名</th>
                                        <th>类型</th>
                                        <th>是否选择</th>
                                        <th>字段映射名称</th>
                                        <th>转换表达式</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>CUST_ID</td>
                                        <td>客户编码</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" checked onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="customerId"></td>
                                        <td>
                                          <div class="expr-input-wrap" style="position:relative;display:block;">
                                            <input type="text" class="form-control form-control-sm" placeholder="请输入转换表达式" style="width:100%;padding-right:30px;">
                                            <span class="expr-query-btn" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:16px;color:#2176c7;z-index:2;" title="表达式编辑" onclick="window.open('expression.html','_blank','width=700,height=500')">🔍</span>
                                          </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>CUST_NAME</td>
                                        <td>客户名称</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" checked onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="customerName"></td>
                                        <td>
                                          <div class="expr-input-wrap" style="position:relative;display:block;">
                                            <input type="text" class="form-control form-control-sm" placeholder="请输入转换表达式" style="width:100%;padding-right:30px;">
                                            <span class="expr-query-btn" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:16px;color:#2176c7;z-index:2;" title="表达式编辑" onclick="window.open('expression.html','_blank','width=700,height=500')">🔍</span>
                                          </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>ADDRESS</td>
                                        <td>地址</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" checked onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="address"></td>
                                        <td>
                                          <div class="expr-input-wrap" style="position:relative;display:block;">
                                            <input type="text" class="form-control form-control-sm" placeholder="请输入转换表达式" style="width:100%;padding-right:30px;">
                                            <span class="expr-query-btn" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:16px;color:#2176c7;z-index:2;" title="表达式编辑" onclick="window.open('expression.html','_blank','width=700,height=500')">🔍</span>
                                          </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>CONTACT</td>
                                        <td>联系人</td>
                                        <td>String</td>
                                        <td><input type="checkbox" class="form-check-input" onchange="toggleMappingEditable(this)"></td>
                                        <td><input type="text" class="form-control form-control-sm mapping-input" value="contact"></td>
                                        <td>
                                          <div class="expr-input-wrap" style="position:relative;display:block;">
                                            <input type="text" class="form-control form-control-sm" placeholder="请输入转换表达式" style="width:100%;padding-right:30px;">
                                            <span class="expr-query-btn" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:16px;color:#2176c7;z-index:2;" title="表达式编辑" onclick="window.open('expression.html','_blank','width=700,height=500')">🔍</span>
                                          </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 数据范围配置 Tab -->
        <div class="tab-pane fade" id="data-scope" role="tabpanel" aria-labelledby="data-scope-tab">
            <iframe src="condition.html" style="width:100%;min-height:600px;border:none;border-radius:8px;"></iframe>
        </div>

        <!-- 服务接口预览 Tab -->
        <div class="tab-pane fade" id="format-preview" role="tabpanel" aria-labelledby="format-preview-tab">
            <table class="table table-bordered m-0 config-table-in-tab">
                 <tbody>
                    <tr>
                        <td>查询服务格式</td>
                        <td>
<pre class="bg-light p-3 rounded"><code>{
  "dataType": "客户主数据",
  "operation": "QUERY",
  "timestamp": "2024-01-15T10:30:00Z",
  "query": {
    "customerId": "CUST001",
    "customerName": "张三"
  }
}</code></pre>
                        </td>
                    </tr>
                     <tr>
                        <td>返回数据格式</td>
                        <td>
<pre class="bg-light p-3 rounded"><code>{
  "data": [
    {
      "customerId": "CUST001",
      "customerName": "张三",
      "contactPhone": "13800138000",
      "email": "zhangsan@example.com",
      "orders": [
        {
          "orderId": "ORD1001",
          "orderDate": "2024-01-10",
          "amount": 1200.5
        },
        {
          "orderId": "ORD1002",
          "orderDate": "2024-01-12",
          "amount": 800.0
        }
      ]
    },
    {
      "customerId": "CUST002",
      "customerName": "李四",
      "contactPhone": "13900139000",
      "email": "lisi@example.com",
      "orders": [
        {
          "orderId": "ORD1003",
          "orderDate": "2024-01-15",
          "amount": 500.0
        }
      ]
    }
  ]
}</code></pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <div style="position:fixed;left:0;right:0;bottom:0;z-index:9999;background:#fff;border-top:1px solid #e9ecef;padding:8px 24px;display:flex;justify-content:flex-end;gap:16px;">
        <button class="btn btn-primary btn-sm">保存</button>
        <button class="btn btn-success btn-sm">启用</button>
    </div>

</div>
<script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    // 初始化所有工具提示
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    function toggleMappingEditable(checkbox) {
        var row = checkbox.closest('tr');
        var mappingInput = row.querySelector('.mapping-input');
        var editableCheckbox = row.querySelector('.editable-checkbox');
        if (checkbox.checked) {
            mappingInput.removeAttribute('readonly');
            mappingInput.classList.remove('bg-light');
            editableCheckbox.removeAttribute('disabled');
            editableCheckbox.classList.remove('bg-light');
        } else {
            mappingInput.setAttribute('readonly', 'readonly');
            mappingInput.classList.add('bg-light');
            editableCheckbox.setAttribute('disabled', 'disabled');
            editableCheckbox.classList.add('bg-light');
        }
    }
    document.querySelectorAll('.form-check-input[type=checkbox]').forEach(function(cb){
        if(cb.onchange) cb.onchange(cb);
    });
</script>
</body>
</html> 